// 压缩文件释义
// _0x0 => THREE
// q4 => PerspectiveCamera 透视摄像机
// q5 => Render 
// ss  =>  Scene  场景
// _1024
// _1042 

// 自定义方法
// _0x4B
//  _0x5B
//  _0x6B 
//  _0x7B
var $jscomp = { scope: {} }
$jscomp.defineProperty =
  'function' == typeof Object.defineProperties
    ? Object.defineProperty
    : function (a, b, c) {
        if (c.get || c.set)
          throw new TypeError('ES3 does not support getters and setters.')
        a != Array.prototype && a != Object.prototype && (a[b] = c.value)
      }
$jscomp.getGlobal = function (a) {
  return 'undefined' != typeof window && window === a
    ? a
    : 'undefined' != typeof global
    ? global
    : a
}
$jscomp.global = $jscomp.getGlobal(this)
$jscomp.SYMBOL_PREFIX = 'jscomp_symbol_'
$jscomp.initSymbol = function () {
  $jscomp.initSymbol = function () {}
  $jscomp.global.Symbol || ($jscomp.global.Symbol = $jscomp.Symbol)
}
$jscomp.symbolCounter_ = 0
$jscomp.Symbol = function (a) {
  return $jscomp.SYMBOL_PREFIX + (a || '') + $jscomp.symbolCounter_++
}
$jscomp.initSymbolIterator = function () {
  $jscomp.initSymbol()
  var a = $jscomp.global.Symbol.iterator
  a || (a = $jscomp.global.Symbol.iterator = $jscomp.global.Symbol('iterator'))
  'function' != typeof Array.prototype[a] &&
    $jscomp.defineProperty(Array.prototype, a, {
      configurable: !0,
      writable: !0,
      value: function () {
        return $jscomp.arrayIterator(this)
      },
    })
  $jscomp.initSymbolIterator = function () {}
}
$jscomp.arrayIterator = function (a) {
  var b = 0
  return $jscomp.iteratorPrototype(function () {
    return b < a.length ? { done: !1, value: a[b++] } : { done: !0 }
  })
}
$jscomp.iteratorPrototype = function (a) {
  $jscomp.initSymbolIterator()
  a = { next: a }
  a[$jscomp.global.Symbol.iterator] = function () {
    return this
  }
  return a
}
$jscomp.makeIterator = function (a) {
  $jscomp.initSymbolIterator()
  $jscomp.initSymbol()
  $jscomp.initSymbolIterator()
  var b = a[Symbol.iterator]
  return b ? b.call(a) : $jscomp.arrayIterator(a)
}
var QModel = function (a) {
  this._0x3B2 = a
}
QModel.prototype = {
  get_current_fileId: function () {
    return newNetHandle._0xA08()
  },
  get_camera_json: function (a) {
    return this._0x3B2._0xE7()
  },
  set_camera_json: function (a) {
    this._0x3B2._0xE8(a)
  },
  get_all_marks: function () {
    return this._0x3B2._0xF2()
  },
  reset_marks: function (a) {
    this._0x3B2._0xF3(a)
  },
  set_mark_click_callback: function (a) {
    this._0x3B2.set_0xB9(a)
  },
  remove_all_marks: function () {
    this._0x3B2._0xF7()
  },
  get_selection_ids: function () {
    return this._0x3B2._0xC4()
  },
  set_comps_visiblity: function (a, b) {
    this._0x3B2._0xC7(a, b)
  },
  set_comps_color: function (a, b) {
    this._0x3B2._0xC6(a, b)
  },
  show_all_comps: function () {
    this._0x3B2._0xD10(!0)
  },
  set_select_callback: function (a) {
    this._0x3B2.setSelectCallback(a)
  },
  set_comps_transparency: function (a, b) {
    this._0x3B2._0xC5(a, b)
  },
  goto_view: function (a) {
    this._0x3B2._007(a)
  },
  lookat_comp: function (a) {
    this._0x3B2._008(a)
  },
}
// 网络处理
var GetNetHandle = function (a) {
    return new Promise(function (b, c) {
      newNetHandle = new NetHandle(a)
      newNetHandle.getToken().then(function (a) {
        b(a)
      })
    })
  },
  // 获取模型
  GetQModel = function (a, b) {
    pageinit()
    viewcubeanimate()
    var c = this
    return new Promise(function (d, f) {
      c.init(a, b).then(function (a) {
        c.animate()
        $('.qm-loading').hide()
        doForMobile()
        d(a)
      })
    })
  }
  /**
   * 二维码生成
   * @param {标签} a 
   * @param {url} b 
   * @param {宽} c 
   * @param {高} d 
   */
function createQrCode(a, b, c, d) {
  a.qrcode({ width: c, height: d, text: b })
}
var camera,
  scene,
  controls,
  renderer,
  viewcube,
  _0x5A = [],
  mouseInfo,
  tube,
  _1024,
  newNetHandle,
  _0x8C,
  ClipIndex = -1
function _004G(a) {
  _1024._004(a)
}
function _00FG(a) {
  _1024._00F(a)
}
function _006G(a) {
  _1024._006(a)
}
function _005G(a) {
  _1024._005(a)
}
function _001G(a) {
  _1024._001(a)
}
function pageinit() {
  $('.qm-title').on('mousedown', OnbfTitleClick) // 目录树拖动事件, 鼠标进入事件
  $('.qm-close').on('click', OnbfCloseClick) // 目录树右上角×的点击关闭事件
  $('.qm-select-current').on('click', OnbfSelectionClick) // x轴点击事件
  $('.qm-select-option').on('click', OnbfSelectionOptionClick) // x轴下列表的点击事件
  $('.my-axial').on('click', OnbfSelectionOptionAxialClick) // x轴,y轴等轴的点击事件
  $('#divProperty').preventScroll()
  $('#divBfTree').preventScroll()
  // #treeComponent没有搜到
  $('#treeComponent').on('click', function () {
    _1024._0xC2(1)
  })
  // #treeAll没有搜到
  $('#treeAll').on('click', function () {
    _1024._0xC2(0)
  })
   // #treeLevel没有搜到
  $('#treeLevel').on('click', function () {
    _1024._0xC2(2)
  })
  // 炸开按钮选中后 进度条事件
  document.querySelector('#myRange').addEventListener('input', function (a) {
    _1024._0xBD(10 * this.value)
  })
  // 目录树显示列表事件
  $('.qm-tree-toolbar').on('click', function (a) {
    document.getElementById('divTree').style.display = 'block'
  })
  // 构件详情
  $('.qmd-properties').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('property-panel').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('property-panel').style.display = 'block'))
  })
  // 进度计划
  $('.qmd-plan').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('property-plan').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('property-plan').style.display = 'block'),
        _1024._00C())
  })
  // 新增任务
  $('#property-plan-add').on('click', function (a) {
    document.getElementById('property-plan-dialog').style.display = 'block'
  })
  // 进度模拟
  $('#property-plan-play').on('click', function (a) {
    _1024._002()
  })
  // 新增计划-保存按钮
  $('#property-plan-add-save').on('click', function (a) {
    document.getElementById('property-plan-dialog').style.display = 'none'
    newNetHandle.saveSche(inp1.value, inp2.value).then(function (a) {
      1 === a && _1024._00C()
    })
  })
  // 相机书签
  $('.qmd-view').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('property-view').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('property-view').style.display = 'block'),
        _1024._00A())
  })
  // 新增书签
  $('#property-view-add').on('click', function (a) {
    document.getElementById('property-view-dialog').style.display = 'block'
  })
  // 插入标记
  $('#property-view-addpoint').on('click', function (a) {
    _1024._0xF7()
    _1024._0xE9(!0, function () {
      _1024._0xE9(!1, null)
    })
  })
  // 打开书签
  $('#property-view-openAll').on('click', function (a) {
    _1024._0xF7()
    _1024._00B()
  })
  // 新增书签-保存
  $('#property-view-add-save').on('click', function (a) {
    document.getElementById('property-view-dialog').style.display = 'none'
    document.createElement('canvas').getContext('2d')
    a = document.getElementById('canvasmain')
    var b = a.width,
      c = a.height,
      d = b,
      f = c
    if (300 < b || 300 < c)
      1 < b / c
        ? ((d = 300), (f = Math.round((c / b) * 300)))
        : ((f = 300), (d = Math.round((b / c) * 300)))
    var k = new Image()
    k.onload = function () {
      var a = document.createElement('canvas'),
        b = a.getContext('2d'),
        c = this.width,
        l = this.height
      a.width = d
      a.height = f
      b.drawImage(k, 0, 0, c, l, 0, 0, d, f)
      a.toBlob(function (b) {
        newNetHandle
          .saveViewAndImg(inviewname.value, _1024._0xE7(), _1024._0xF2(), b)
          .then(function (b) {
            a = null
            1 === b && _1024._00A()
          })
      })
      k = k.onload = null
    }
    k.src = a.toDataURL('image/png', 0.5)
  })
  // 轴向剖切
  $('.qmd-section-axial').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('axiDiv').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('axiDiv').style.display = 'block'))
  })
  // 基本信息
  $('.qmd-information').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('modalInfoDiv').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('modalInfoDiv').style.display = 'block'))
  })
  // 炸开
  $('.qmd-lookat').on('click', function (a) {
    a.target.classList.contains('qm-checked')
      ? (a.target.classList.remove('qm-checked'),
        (document.getElementById('myRange').style.display = 'none'))
      : (a.target.classList.add('qm-checked'),
        (document.getElementById('myRange').style.display = 'block'))
  })
  // 框选
  $('.qmd-zoomrect').on('click', function (a) {
    _1024._0xD4()
    a.target.classList.contains('qm-checked')
      ? a.target.classList.remove('qm-checked')
      : a.target.classList.add('qm-checked')
  })
  // 测量
  $('.qmd-measure').on('click', function (a) {
    _1024.setMeasure()
    a.target.classList.contains('qm-checked')
      ? a.target.classList.remove('qm-checked')
      : a.target.classList.add('qm-checked')
  })
  $('.qmd-circlelook').on('click', function (a) {
    _1024._0x1E = !_1024._0x1E
    a.target.classList.contains('qm-checked')
      ? a.target.classList.remove('qm-checked')
      : a.target.classList.add('qm-checked')
  })
  // 漫游模式
  $('.qmd-walk').on('click', function (a) {
    _1024.stopRander = !0
    a.target.classList.contains('qm-checked')
      ? a.target.classList.remove('qm-checked')
      : a.target.classList.add('qm-checked')
    _1024.setWalk()
    controls = _1024._0x9A(1, renderer.domElement)
    _1024.stopRander = !1
  })
  // 标记
  $('.qmd-dingwei').on('click', function (a) {
    var b = a.target.classList.contains('qm-checked')
    b
      ? a.target.classList.remove('qm-checked')
      : a.target.classList.add('qm-checked')
    _1024._0xE9(!b)
  })
  // home主页
  $('.qmd-home').on('click', function () {
    _1024._0x1EFun()
  })
  // 轴向剖切 
  $('#axial-progress').on('click', function (a) {
    a.returnValue = !1
    a.stopPropagation()
  })
  $('#axial-progress').on('mousedown', function (a) {
    a.returnValue = !1
    a.stopPropagation()
  })
  $('#axial-progress').on('mouseup', function (a) {
    a.returnValue = !1
    a.stopPropagation()
  })
  $('#axial-progress').on('input propertychange', function (a) {
    console.log(a.target.value)
    _0xE4(ClipIndex, a.target.value)
  })
}
function init(a, b) {
  console.log('\u521d\u59cb\u5316')
  document.body.style.margin = '0px'
  var c = document.getElementById('container')
  c.addEventListener('mousedown', onDocumentMouseDown, !1)
  c.addEventListener('mousemove', onDocumentMouseMove, !1)
  c.addEventListener('wheel', onDocumentMouseMove, { passive: !1 })
  c.addEventListener('mouseup', onDocumentMouseUp, !1)
  c.addEventListener('touchstart', onDocumentMouseDownm, !1)
  c.addEventListener('touchmove', onDocumentMouseMovem)
  c.addEventListener('touchend', onDocumentMouseUpm)
  camera = new THREE.q4(60, b.pageWidth / b.pageHeight, 0.1, 1e4)
  camera.up.set(0, 0, 1)
  scene = new THREE.ss()
  camera.position.set(300, -300, 300)
  _1024 = new _0x3B2(camera, scene, newNetHandle, b)
  _1024.setOnchange(function () {
    requestAnimationFrame(animate)
    _1024.updateLOD()
  })
  renderer = new THREE.q5({
    canvas: document.getElementById('canvasmain'),
    antialias: !0,
    preserveDrawingBuffer: !0,
  })
  renderer.autoClearColor = !1
  renderer.sortObjects = !0
  renderer.setPixelRatio(window.devicePixelRatio)
  controls = _1024._0x9A(0, renderer.domElement)
  _0x4B(_1024)
  var d = b.backgroundColor
  console.log(new Date())
  var f = new QModel(_1024),
    c = new Promise(function (c, g) {
      0 == b.type
        ? (console.log('rvt model'),
          newNetHandle.getModel(a).then(function (a) {
            _1024._0xC1(a, b.version).then(function (a) {
              console.log(new Date())
              scene.background = d
                ? new THREE.Color(parseInt(d))
                : new THREE.Color(14082283)
              renderer.setClearColor(1540019, 1)
              renderer.setSize(b.pageWidth, b.pageHeight)
              _1024._0xF10(renderer)
              _1024._0xD1()
              console.log(new Date())
              c(f)
            })
          }))
        : 1 == b.type
        ? (console.log('survey model'),
          (_1024.isSurvey = 1 == b.type),
          newNetHandle.getModel(a).then(function (a) {
            _1024._0x3F(a).then(function (a) {
              console.log(new Date())
              scene.background = d
                ? new THREE.Color(parseInt(d))
                : new THREE.Color(15988220)
              renderer.setClearColor(1540019, 1)
              renderer.setSize(b.pageWidth, b.pageHeight)
              _1024._0xF10(renderer)
              _1024._0xD1()
              console.log(new Date())
              c(f)
            })
          }))
        : 2 == b.type &&
          (console.log('survey model'),
          (_1024.isSurvey = 1 == b.type),
          newNetHandle.getModel(a).then(function (a) {
            _1024._0x3Fdwg(a).then(function (a) {
              console.log(new Date())
              scene.background = d
                ? new THREE.Color(parseInt(d))
                : new THREE.Color(16776958)
              renderer.setClearColor(1540019, 1)
              renderer.setSize(b.pageWidth, b.pageHeight)
              _1024._0xF10(renderer)
              _1024._0xD1()
              console.log(new Date())
              c(f)
            })
          }))
    })
  window.addEventListener('resize', onWindowResize, !1)
  return c
}
function getUrlParam(a) {
  a = new RegExp('(^|\x26)' + a + '\x3d([^\x26]*)(\x26|$)')
  a = window.location.search.substr(1).match(a)
  return null != a ? unescape(decodeURI(a[2])) : null
}
function onWindowResize() {
  _1024.resize()
}
function animate() {
  _1024.Myrander()
}
function viewcubeanimate() {
  viewcube && viewcube.update()
  requestAnimationFrame(viewcubeanimate)
}
function walk() {
  if (87 == event.keyCode) {
    var a = _1024._0xD5()
    console.log(a)
  }
  console.log(camera)
}
function onDocumentMouseDown(a) {
  console.log(a)
  'CANVAS' == a.target.tagName &&
    ((mouseInfo = { start: [a.x, a.y], down: a.button, target: a.target }),
    _1024.mouseDown(a))
}
function onDocumentMouseDownm(a) {
  console.log(a)
  'CANVAS' == a.target.tagName &&
    ((mouseInfo = {
      start: [a.touches[0].clientX, a.touches[0].clientY],
      down: 0,
      target: a.target,
    }),
    _1024.mouseDown({
      clientX: a.touches[0].clientX,
      clientY: a.touches[0].clientY,
    }))
}
function onDocumentMouseUp(a) {
  if ('CANVAS' == a.target.tagName && mouseInfo) {
    var b = mouseInfo.start[0],
      c = mouseInfo.start[1]
    console.log(mouseInfo)
    mouseInfo = null
    0 == a.button && _1024.mouseUp(a, 0 != a.x - b || 0 != a.y - c)
  }
}
function onDocumentMouseUpm(a) {
  if ('CANVAS' == a.target.tagName && mouseInfo) {
    var b = mouseInfo.start[0],
      c = mouseInfo.start[1]
    console.log(mouseInfo)
    mouseInfo = null
    var d = !1
    0 != a.changedTouches[0].clientX - b &&
      0 != a.changedTouches[0].clientY - c &&
      (d = !0)
    _1024.mouseUp(
      {
        clientX: a.changedTouches[0].clientX,
        clientY: a.changedTouches[0].clientY,
      },
      d
    )
  }
}
function onDocumentMouseMove(a) {
  _1024.mouseOver(a, mouseInfo)
}
function onDocumentMouseMovem(a) {
  _1024.mouseOver(
    { clientX: a.touches[0].clientX, clientY: a.touches[0].clientY },
    mouseInfo
  )
}
function onDocumentMouseWheel(a) {
  _1024.mouseWheel(a)
}
function onShowdiv(a) {
  a = document.getElementById(a)
  a.classList.contains('hide')
    ? a.classList.remove('hide')
    : a.classList.add('hide')
}
function onClip(a) {
  ;-1 != ClipIndex && _1024.SetClipVisible(a)
}
function _0xE4(a, b) {
  _1024._0xE4(a, b)
}
function MouseWheel(a) {
  a = a || window.event
  a.stopPropagation ? a.stopPropagation() : (a.cancelBubble = !0)
  a.preventDefault ? a.preventDefault() : (a.returnValue = !1)
}
function _0xF8() {
  _1024._0xF8()
}
function initTree() {
  var a = new TreeNode('\u5168\u90e8\u5206\u7c7b1')
  document.getElementById('divBfTree').appendChild(a.element)
  var b = new TreeNode('JModelByZhengtengzhou')
  a.addChildNode(b)
}
function setClipIndex(a) {
  ;-1 == ClipIndex
    ? ((ClipIndex = a), onClip(ClipIndex))
    : ClipIndex != a
    ? (onClip(ClipIndex), (ClipIndex = a), onClip(ClipIndex))
    : (onClip(ClipIndex), (ClipIndex = -1))
}
// x轴,y轴等轴的点击事件
function OnbfSelectionOptionAxialClick(a) {
  'X\u8f74' === a.target.innerHTML && setClipIndex(0)
  'Y\u8f74' === a.target.innerHTML && setClipIndex(1)
  'Z\u8f74' === a.target.innerHTML && setClipIndex(2)
  '-X\u8f74' === a.target.innerHTML && setClipIndex(3)
  '-Y\u8f74' === a.target.innerHTML && setClipIndex(4)
  '-Z\u8f74' === a.target.innerHTML && setClipIndex(5)
  a.target.classList.contains('axial-checked')
    ? a.target.classList.remove('axial-checked')
    : a.target.classList.add('axial-checked')
}
// x轴下列表的点击事件
function OnbfSelectionOptionClick(a) {
  console.log(a.target)
  var b = a.target.parentNode.parentNode.getElementsByClassName(
    'qm-select-current'
  )
  b[0].innerHTML = a.target.innerHTML
  b[0].classList.remove('qm-open')
}
// x轴点击事件
function OnbfSelectionClick(a) {
  console.log(a.target)
  a = a.target
  a.classList.contains('qm-open')
    ? a.classList.remove('qm-open')
    : a.classList.add('qm-open')
}
// 目录树右上角×的点击关闭事件
function OnbfCloseClick(a) {
  console.log(a.target)
  a.target.parentNode.style.display = 'none'
}
// 适配手机
function doForMobile() {
  var a = navigator.userAgent.toLowerCase(),
    b = 'ipad' == a.match(/ipad/i),
    c = 'iphone os' == a.match(/iphone os/i),
    d = 'midp' == a.match(/midp/i),
    f = 'rv:1.2.3.4' == a.match(/rv:1.2.3.4/i),
    k = 'ucweb' == a.match(/ucweb/i),
    g = 'android' == a.match(/android/i),
    h = 'windows ce' == a.match(/windows ce/i),
    a = 'windows mobile' == a.match(/windows mobile/i),
    n = !0
  if (500 > window.innerWidth || b || c || d || f || k || g || h || a) n = !1
  n
    ? ($('#property-panel').show(),
      $('#divTree').show(),
      $('#demoSDK').show(),
      $('#qrcode1').show(),
      $('.qmd-properties')[0].classList.add('qm-checked'))
    : ($('.qmd-information').hide(),
      $('.qmd-firstperson').hide(),
      $('.qmd-lookat').hide(),
      $('.qmd-measure').hide(),
      $('.qmd-zoomrect').hide())
}
// 目录树拖动事件, 鼠标进入事件
function OnbfTitleClick(a) {
  function b(a) {
    a || (a = window.event)
    d.style.left = a.clientX - f + 'px'
    d.style.top = a.clientY - k + 'px'
    a.cancelBubble = !0
  }
  function c(a) {
    console.log('end')
    a || (a = window.event)
    document.removeEventListener('mousemove', b)
    document.removeEventListener('mouseup', c)
    a.cancelBubble = !0
  }
  console.log(a.target)
  var d = a.target.parentNode,
    f = event.clientX - parseInt(d.style.left)
  '50%' == d.style.left && (f = event.clientX - 0.5 * document.body.clientWidth)
  '' == d.style.left && (f = event.clientX - parseInt(d.offsetLeft))
  var k = event.clientY - parseInt(d.style.top)
  '50%' == d.style.left &&
    (k = event.clientY - 0.5 * document.body.clientHeight)
  '' == d.style.left && (k = event.clientY - parseInt(d.offsetTop))
  document.addEventListener('mousemove', b)
  document.addEventListener('mouseup', c)
  console.log('begin')
  event.cancelBubble = !0
  event.returnValue = !1
}
// 自定义方法
function _0x4B(a) {
  var b = document.getElementById('viewcube')
  viewcube = new FOUR.b5({
    domElement: b,
    labelSize: 150,
    labelFontSize: 36,
    updateTween: !1,
    display: { sceneAxis: !0 },
    viewport: { camera: camera },
    viewer: a,
  })
  viewcube.enable()
  controls.addEventListener('change', function () {
    viewcube.updateOrientation()
  })
  viewcube.addEventListener('update', function (a) {
    a = a.direction
    _0x6B(camera, new THREE._0x1(), a.yaw, a.pitch, !0)
  })
}
function _0x5B(a, b) {
  var c = new THREE.b6(),
    d = new THREE._0x1(),
    f = new THREE.Quaternion().setFromUnitVectors(a.up, new THREE._0x1(0, 1, 0))
  d.copy(a.position).sub(b)
  d.applyQuaternion(f)
  c.setFrom_0x1(d)
  return { yaw: c.theta, pitch: Math.PI / 2 - c.phi }
}
function _0x6B(a, b, c, d, f) {
  'undefined' === typeof f && (f = !1)
  f ? _0x7B(a, b, c, d) : _0x8B(a, b, c, d)
}
var _hmt = _hmt || []
;(function () {
  var a = document.createElement('script')
  a.src = 'https://hm.baidu.com/hm.js?1a7d7cf12f34ab1c37040f9d511cbda8'
  var b = document.getElementsByTagName('script')[0]
  b.parentNode.insertBefore(a, b)
})()
function _0x7B(a, b, c, d) {
  var f = _0x5B(a, b),
    k = { yaw: c, pitch: d },
    g = new b4.Tween(f).to(k, 1e3)
  g.easing(b4.Easing.Cubic.InOut)
  g.onComplete(function () {
    _0x8B(a, b, c, d)
    g.stop()
  })
  g.onUpdate(function () {
    _0x8B(a, b, this.yaw, this.pitch)
  })
  g.start()
}
function _0x8B(a, b, c, d) {
  var f = new THREE.b6(),
    k = new THREE._0x1(),
    g = new THREE.Quaternion().setFromUnitVectors(a.up, new THREE._0x1(0, 1, 0)),
    h = g.clone().inverse()
  k.copy(a.position).sub(b)
  k.applyQuaternion(g)
  f.setFrom_0x1(k)
  d = -d + Math.PI / 2 - f.phi
  f.theta += c - f.theta
  f.phi += d
  f.makeSafe()
  k.setFromb6(f)
  k.applyQuaternion(h)
  a.position.copy(b).add(k)
  a.lookAt(b)
}
var QmParams = function () {
    this._0x4D = 'none'
    this.version = 4
    this.merge = !1
    this.backgroundColor = 16777215
    this._0x9C = !1
    this.markId = this.lookat = null
    this.type = this.pageHeight = this.pageWidth = 1
  },
  _0x3B2 = function (a, b, c, d) {
    this.stopRander = !1
    this._0x1C = this._0x3B = this._0x0C = this.tube = null
    this._0x9C = d._0x9C
    this._012 = d._012
    this._0x0D = null
    this._0x1D = []
    this._0x1DSrc = []
    this._0x6C = !1
    this._0x7C = []
    this._0x8C = null
    this.Empty = Object.freeze([])
    this._0x2D = null
    this._0x3D = []
    this._0x3Dqm = new Map()
    this._0x3C = this._0x2C = null
    this._0xB3 = []
    this._0x9B = a
    this._0x0B = b
    this._0x6E = null
    this._0x5A = []
    this._0xB6 = null
    this._0x4C = { Enable: !1, ClipIndex: 0, Value: 0 }
    this._0xB7 = []
    this._0x5C = !1
    this._0xB4 = this._0x5CCl = null
    this._0x5D = []
    this._0x6D = null
    this._0x7D = !1
    this._0xA06 = this._0x7E = null
    this.mfi = 0
    this.myOne = new THREE._0x2()
    this.mgr = d.merge
    this.mtrMap = new Map()
    this.mgrGlobal_0x6s = { objs: [], geometries: [] }
    this._0x8E = null
    this._0xA04 = new THREE.b7()
    this._0xA05 = new THREE._0x1()
    this.testMatrix = new THREE.Matrix4().set(
      1,
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      1
    )
    this.mpacate = new Map()
    this._0x4Di = this._0x4D = ''
    this.transcmps = []
    this._0x8D = !1
    this._0x0E = this._0x9D = null
    this.sceneGroup = new THREE.Group()
    this.sceneGroup.applyMatrix4(this.testMatrix)
    this._0x0B.add(this.sceneGroup)
    this.net = c
    this.viewList = []
    this.mversion = 0
    this.onChangeCallBack = this._0xB9 = this._0xB8 = this.worker = null
    this.crm = 0
    this.tmpOn = 1
    this.radius = 500
    this.theta = 0
    this._0x1E = !1
    this.log_face_count = 0
    this.size = { w: d.pageWidth, h: d.pageHeight }
    this.isSurvey = !1
    this.defaultHideTypes = [-2000160]
    this._0x9E = [
      255,
      65280,
      16711680,
      4095,
      16773120,
      8912896,
      34816,
      34952,
      17476,
      65416,
      921992,
      14492296,
    ]
    this._0x0F = null
    this.octree = new THREE.Octree({
      undeferred: !1,
      depthMax: Infinity,
      objectsThreshold: 16,
      overlapPct: 0.15,
    })
    this.qmtree = new Map()
    this.qmlist = new Map()
    this.qmidmap = new Map()
    this._0x2E = [
      new THREE.pl(new THREE._0x1(1, 0, 0), 0),
      new THREE.pl(new THREE._0x1(0, 1, 0), 0),
      new THREE.pl(new THREE._0x1(0, 0, 1), 0),
      new THREE.pl(new THREE._0x1(-1, 0, 0), 0),
      new THREE.pl(new THREE._0x1(0, -1, 0), 0),
      new THREE.pl(new THREE._0x1(0, 0, -1), 0),
    ]
  }
_0x3B2.prototype = {
  _0x1F: function () {
    var a = this
    return new Promise(function (b, c) {
      var d = window.indexedDB.open('mydbv1', 4)
      d.onsuccess = function (c) {
        a._0xA06 = c.target.result
        b(1)
      }
      d.onupgradeneeded = function (b) {
        db = b.target.result
        a._0xA06 = db
        if (!db.objectStoreNames.contains('ssn'))
          var c = db.createObjectStore('ssn', { keyPath: 'id' })
        a._0x8E = c
      }
      d.onerror = function (a) {
        console.log('\u6570\u636e\u5e93\u6253\u5f00\u62a5\u9519')
        b(0)
      }
    })
  },
  _0xC1: function (a, b) {
    var c = this
    b = parseInt(b)
    this._0x4D = a
    this.mversion = b
    this._0x4Di = this.net._0xA08()
    return new Promise(function (a, b) {
      c._0x1F().then(function (b) {
        var d = c._0xA06
          .transaction(['ssn'], 'readonly')
          .objectStore('ssn')
          .get(c._0x4Di + '-all')
        d.onerror = function (b) {
          console.log('\u4e8b\u52a1\u5931\u8d25')
          a(0)
        }
        d.onsuccess = function (b) {
          d.result
            ? c._0xC1db().then(function (b) {
                a(b)
                c.onChangeCallBack()
              })
            : c.net.MDV
            ? c._0xC1Worker().then(function (b) {
                c.onChangeCallBack()
                a(b)
              })
            : c._0xC1l().then(function (b) {
                c.onChangeCallBack()
                a(b)
              })
        }
      })
    })
  },
  _0xC1db: function () {
    var a = this
    return new Promise(function (b, c) {
      var d = a._0xA06.transaction(['ssn']).objectStore('ssn'),
        f = d.get(a._0x4Di + '-3d'),
        k = d.get(a._0x4Di + '-data')
      k.onsuccess = function () {
        function b(b) {
          return new Promise(function (c, d) {
            var f = a._0xA06
              .transaction(['ssn'])
              .objectStore('ssn')
              .get(a._0x4Di + '-data-' + b)
            f.onsuccess = function (b) {
              result2 = f.result.values
              a._0x3C.Cmps.push.apply(a._0x3C.Cmps, result2)
              c('1')
            }
          })
        }
        a._0x3C = k.result.values
        a._0x3C.Cmps = []
        for (var c = 0; c < a._0x3C.GroupCount; c++) b(c)
        console.log('\u6570\u636e\u5ef6\u8fdf\u52a0\u8f7d\u5b8c\u6210')
      }
      f.onerror = function (a) {
        console.log('\u4e8b\u52a1\u5931\u8d25')
      }
      f.onsuccess = function (c) {
        if (f.result) {
          var d = function () {
              a._0x3D = []
              var b = 0,
                c = m.Instances.length
              return new Promise(function (d, f) {
                for (
                  var g = {}, k = 0;
                  k < m.Instances.length;
                  g = { _i: g._i }, k++
                )
                  (g._i = k),
                    setTimeout(
                      (function (c) {
                        return function () {
                          var f = a._0xA06
                            .transaction(['ssn'])
                            .objectStore('ssn')
                            .get(a._0x4Di + '-' + m.Instances[c._i])
                          f.onsuccess = function (c) {
                            c = f.result.values
                            for (var d = 0; d < c.list.length; d++) {
                              var g = c.list[d]
                              if (null != g.Bi) {
                                var k = c.position.subarray(
                                    g.Bi[0],
                                    g.Bi[0] + g.Bi[1]
                                  ),
                                  h = c.normal.subarray(
                                    g.Bi[0],
                                    g.Bi[0] + g.Bi[1]
                                  ),
                                  l = c.color.subarray(
                                    g.Bi[0],
                                    g.Bi[0] + g.Bi[1]
                                  ),
                                  m = c.uv.subarray(g.Bi[2], g.Bi[2] + g.Bi[3])
                                a._0x1AIns2(g, k, h, l, m)
                              }
                            }
                            b++
                          }
                          f.onerror = function (a) {
                            console.log('\u4e8b\u52a1\u5931\u8d25')
                            d(0)
                          }
                        }
                      })(g),
                      10
                    )
                var h = setInterval(function () {
                  b == c &&
                    (clearInterval(h),
                    console.log('instance-count:' + a._0x3D.length),
                    d(1))
                }, 200)
              })
            },
            g = function () {
              var c = m.GroupCount,
                d = 0
              a.stopRander = !0
              for (var f = 0; f < m.GroupCount; f++)
                (function (b) {
                  setTimeout(function () {
                    p(b, a.mversion).then(function (a) {
                      progressLoad.value = (100 * b) / c
                      document.getElementById('progressInfo').innerHTML =
                        '\u52a0\u8f7d\u4e2d...' +
                        b.toString() +
                        '/' +
                        c.toString()
                      d++
                    })
                  }, 10 * b)
                })(f)
              var g = setInterval(function () {
                if (d == c) {
                  clearInterval(g)
                  k()
                  for (var f = 0; f < a._0x3D; f++)
                    (a._0x3D[f].go = null), (a._0x3D = null)
                  a._0x3D = null
                  a._0x3Dqm.clear()
                  a._0x3Dqm = null
                  a._0xC2(0)
                  a.showLog(
                    '\u6784\u4ef6\u6570\u91cf\u4e3a\uff1a' +
                      a.sceneGroup.children.length
                  )
                  a.showLog('Face\u6570\u91cf\u4e3a\uff1a' + a.log_face_count)
                  document.getElementById('infoCompCount').innerHTML =
                    a.sceneGroup.children.length
                  document.getElementById('infoAngleCount').innerHTML =
                    a.log_face_count
                  document.getElementById('infoPointCount').innerHTML =
                    3 * a.log_face_count
                  progressDiv.style.display = 'none'
                  document.body.background = ''
                  b(1)
                  console.log(a.mpacate)
                  a.stopRander = !1
                }
              }, 1e3)
            },
            k = function () {
              a.mgr &&
                (a.mtrMap.forEach(function (b) {
                  a.createMergena(b.mgr_0x6s, !0)
                }),
                a.createMergena(a.mgrGlobal_0x6s.geometries, !1))
            },
            p = function (b, c) {
              return new Promise(function (c, d) {
                console.log(b)
                var f = a._0xA06.transaction(['ssn']).objectStore('ssn')
                if (a.net.MDV) {
                  var g = f.get(a._0x4Di + '-5d-' + b)
                  g.onsuccess = function (d) {
                    if (null == g.result)
                      a.startOneWorker(a._0x4D, '5d-' + b).then(function (a) {
                        c(a)
                      })
                    else {
                      d = g.result.values
                      for (var f = null, k = 0; k < d.list.length; ) {
                        var h = d.list[k],
                          l = h.Di + ':' + h.Li + ':' + h.Ci,
                          m = a.mpacate.get(l)
                        m ? m++ : (m = 1)
                        a.mpacate.set(l, m)
                        if (a._012) {
                          l = []
                          for (m = k + 1; m < d.list.length; m++)
                            if (d.list[m].Isp && d.list[m].Pi == h.Ui)
                              l.push(d.list[m])
                            else break
                          if (null == h.Bi) {
                            k++
                            continue
                          }
                          var m = d.position.subarray(
                              h.Bi[0],
                              h.Bi[0] + h.Bi[1]
                            ),
                            n = d.normal.subarray(h.Bi[0], h.Bi[0] + h.Bi[1]),
                            p = d.color.subarray(h.Bi[0], h.Bi[0] + h.Bi[1]),
                            r = d.uv.subarray(h.Bi[2], h.Bi[2] + h.Bi[3]),
                            k = k + l.length + 1
                          a._0x1Av7(h, m, n, p, r, l)
                        } else {
                          if (h.Isp || (h.Isi && h.Ui != h.Ii)) {
                            if (f.id == h.Ii || f.id == h.Pi) {
                              k++
                              a.mgr
                                ? a._0x1AMerge(h, f)
                                : a._0x1Av6(h, null, null, null, null, f)
                              continue
                            } else console.log('error model')
                            continue
                          }
                          if (null == h.Bi) {
                            k++
                            continue
                          }
                          f = null
                          m = d.position.subarray(h.Bi[0], h.Bi[0] + h.Bi[1])
                          n = d.normal.subarray(h.Bi[0], h.Bi[0] + h.Bi[1])
                          p = d.color.subarray(h.Bi[0], h.Bi[0] + h.Bi[1])
                          r = d.uv.subarray(h.Bi[2], h.Bi[2] + h.Bi[3])
                          k++
                          f = a.mgr
                            ? a._0x1AMerge(h, f, m, n, p, r)
                            : a._0x1Av6(h, m, n, p, r)
                        }
                        r = p = n = m = null
                      }
                      d.position = null
                      d.normal = null
                      d.color = null
                      d = d.uv = null
                      c(1)
                    }
                  }
                  g.onerror = function (a) {
                    console.log('\u4e8b\u52a1\u5931\u8d25')
                    c(0)
                  }
                } else
                  (g = f.get(a._0x4Di + '-3d-' + b)),
                    (g.onsuccess = function (b) {
                      b = g.result.values
                      for (var d = 0; d < b.length; d++) {
                        var f =
                            b[d].DocId + ':' + b[d].LevelId + ':' + b[d].CatId,
                          h = a.mpacate.get(f)
                        h ? h++ : (h = 1)
                        a.mpacate.set(f, h)
                        f = b[d]
                        f.isPublic ||
                        (f.isInstance && f.UniqueId != f.InstanceId)
                          ? tmpgeometry.UniqueId == f.InstanceId ||
                            tmpgeometry.UniqueId == f.PublicId
                            ? a._0x1Av4(f, tmpgeometry)
                            : console.log('\u5f02\u5e38\u6784\u4ef6')
                          : (tmpgeometry = a._0x1Av4(f))
                      }
                      b.position = null
                      b.normal = null
                      b.color = null
                      b.uv = null
                      c(1)
                    }),
                    (g.onerror = function (a) {
                      console.log('\u4e8b\u52a1\u5931\u8d25')
                      c(0)
                    })
              })
            },
            m = f.result.values
          if (-1 < [3, 4].indexOf(a.mversion))
            for (a._0x1DSrc = m.Mtrs, c = a.mfi = 0; c < m.Mtrs.length; c++)
              a._0x2F(a._0x1D, a._0x1DSrc[c], c)
          var q = setInterval(function () {
            if (a._0x1DSrc.length == a.mfi) {
              clearInterval(q)
              console.log('mtrMap\u6570\u91cf' + a.mtrMap.size)
              console.log('_0x1D\u6570\u91cf ' + a._0x1D.length)
              for (var b = 0; b < a._0x1D.length; b++)
                a.mtrMap.set(a._0x1D[b].uuid, a._0x1D[b])
              m.Instances && 0 < m.Instances.length
                ? d().then(function (a) {
                    g()
                  })
                : g()
            }
          }, 200)
          a._0xB5 = m.SourcePoint
        } else console.log('error-3d')
      }
    })
  },
  setOnchange: function (a) {
    this.onChangeCallBack = a
  },
  startOneWorker: function (a, b) {
    var c = this
    return new Promise(function (d, f) {
      var k = new Worker('bimjs/worker.js')
      k.bi = b
      k.postMessage({ m: a, s: b })
      k.onmessage = function (a) {
        if (a.data.error) d({ result: 0, fileName: b })
        else if (a.data.list) {
          a = a.data
          c._0xA06
            .transaction(['ssn'], 'readwrite')
            .objectStore('ssn')
            .add({ id: c._0x4Di + '-' + k.bi, values: a })
          for (var f = null, g = 0; g < a.list.length; ) {
            var l = a.list[g],
              p = l.Di + ':' + l.Li + ':' + l.Ci,
              m = c.mpacate.get(p)
            m ? m++ : (m = 1)
            c.mpacate.set(p, m)
            if (c._012) {
              p = []
              for (m = g + 1; m < a.list.length; m++)
                if (a.list[m].Isp && a.list[m].Pi == l.Ui) p.push(a.list[m])
                else break
              if (null == l.Bi) g++
              else {
                var m = a.position.subarray(l.Bi[0], l.Bi[0] + l.Bi[1]),
                  q = a.normal.subarray(l.Bi[0], l.Bi[0] + l.Bi[1]),
                  r = a.color.subarray(l.Bi[0], l.Bi[0] + l.Bi[1]),
                  u = a.uv.subarray(l.Bi[2], l.Bi[2] + l.Bi[3]),
                  g = g + p.length + 1
                c._0x1Av7(l, m, q, r, u, p)
              }
            } else
              l.Isp || (l.Isi && l.Ui != l.Ii)
                ? f.id == l.Ii || f.id == l.Pi
                  ? (g++, c._0x1Av6(l, null, null, null, null, f))
                  : console.log('error model')
                : null == l.Bi
                ? g++
                : ((m = a.position.subarray(l.Bi[0], l.Bi[0] + l.Bi[1])),
                  (q = a.normal.subarray(l.Bi[0], l.Bi[0] + l.Bi[1])),
                  (r = a.color.subarray(l.Bi[0], l.Bi[0] + l.Bi[1])),
                  (u = a.uv.subarray(l.Bi[2], l.Bi[2] + l.Bi[3])),
                  g++,
                  (f = c._0x1Av6(l, m, q, r, u)))
          }
          a.position = null
          a.normal = null
          a.color = null
          a.uv = null
        } else
          for (
            a = JSON.parse(a.data),
              c._0xA06
                .transaction(['ssn'], 'readwrite')
                .objectStore('ssn')
                .add({ id: c._0x4Di + '-3d-' + k.bi, values: a }),
              g = 0;
            g < a.length;
            g++
          )
            c._0x1Av5(a[g])
        k && (k.terminate(), (k = null))
        d({ result: 1, fileName: b })
      }
    })
  },
  // 默认加载5d.gz 获取到5d.json的信息
  // 5d.json中包含所需的贴纸图片和将要下载的5d-0.gz, 5d-1.gz的个数
  _0xC1Worker: function () {
    var a = this
    console.log('wk')
    var b = a._0x4D
    this.propertyTable = document.getElementById('treeTable1')
    var c = document.getElementById('progressLoad'),
      d = document.getElementById('progressDiv')
    a.log_face_count = 0
    return new Promise(function (f, k) {
      d.style.display = 'block'
      a.showLog('start \u4e0b\u8f7d\u6a21\u578b')
      JSZipUtils.getBinaryContent(b + '/5d.gz', {
        callback: function (g, h) {
          function k() {
            var g = m.GroupCount,
              k = 0,
              h = 0,
              l = 0,
              n = [],
              p = setInterval(function () {
                m.GroupCount === l &&
                  0 === n.length &&
                  (console.log(
                    '--debuger--\u5b9a\u65f6\u4efb\u52a1\u7ed3\u675f\u3002'
                  ),
                  clearInterval(p))
                for (; (10 > h && l < m.GroupCount) || 0 < n.length; ) {
                  new Worker('bimjs/worker.js')
                  var d = '5d-' + l
                  0 < n.length
                    ? ((d = n.pop()),
                      h++,
                      g++,
                      console.log('\u5f02\u5e38\u91cd\u8bd5:' + d))
                    : (h++, l++)
                  a.startOneWorker(b, d).then(function (a) {
                    1 === a.result
                      ? (k++,
                        h--,
                        console.log(
                          'W-count:' +
                            k +
                            ',i:' +
                            a.fileName +
                            'workercount:' +
                            h
                        ),
                        (c.value = (100 * k) / g),
                        (document.getElementById('progressInfo').innerHTML =
                          '\u9996\u6b21\u4e0b\u8f7d\u89e3\u6790...' +
                          k.toString() +
                          '/' +
                          g.toString()))
                      : (h--,
                        console.log('\u5f02\u5e38\u5165\u6808:' + a.fileName),
                        n.push(a.fileName))
                  })
                }
                10 <= h &&
                  console.log(
                    '--debuger--\u7ebf\u7a0b\u5df2\u8fbe\u4e0a\u9650\u3002'
                  )
              }, 1e3),
              q = setInterval(function () {
                k == g &&
                  (clearInterval(q),
                  a.showLog(
                    '\u6784\u4ef6\u6570\u91cf\u4e3a\uff1a' +
                      a.sceneGroup.children.length
                  ),
                  a.showLog('Face\u6570\u91cf\u4e3a\uff1a' + a.log_face_count),
                  (document.getElementById('infoCompCount').innerHTML =
                    a.sceneGroup.children.length),
                  (document.getElementById('infoAngleCount').innerHTML =
                    a.log_face_count),
                  (document.getElementById('infoPointCount').innerHTML =
                    3 * a.log_face_count),
                  (d.style.display = 'none'),
                  a._0xA06
                    .transaction(['ssn'], 'readwrite')
                    .objectStore('ssn')
                    .add({ id: a._0x4Di + '-all', values: 'ok' }),
                  (document.body.background = ''),
                  f('1'))
              }, 1e3)
          }
          function l() {
            a._0x3D = []
            return new Promise(function (d, f) {
              var g = m.Instances.length,
                k = 0,
                h = 0,
                l = 0,
                n = [],
                p = setInterval(function () {
                  g === l &&
                    0 === n.length &&
                    (console.log(
                      '--debuger--Instance\u5b9a\u65f6\u4efb\u52a1\u7ed3\u675f\u3002'
                    ),
                    clearInterval(p))
                  for (var d = {}; (10 > h && l < g) || 0 < n.length; ) {
                    var f = m.Instances[l]
                    0 < n.length
                      ? ((f = n.pop()),
                        h++,
                        g++,
                        console.log('\u5f02\u5e38\u91cd\u8bd5:' + f))
                      : (h++, l++)
                    d.worker = new Worker('bimjs/worker.js')
                    d.worker.bi = f
                    d.worker.postMessage({ m: b, s: f })
                    d.worker.onmessage = (function (b) {
                      return function (d) {
                        if (d.data.error) n.push(d.data.data.s)
                        else if (d.data.list) {
                          d = d.data
                          console.log(
                            'W-count:' +
                              k +
                              ',i:-' +
                              b.worker.bi +
                              'workercount:' +
                              h
                          )
                          a._0xA06
                            .transaction(['ssn'], 'readwrite')
                            .objectStore('ssn')
                            .add({
                              id: a._0x4Di + '-' + b.worker.bi,
                              values: d,
                            })
                          for (var f = 0; f < d.list.length; f++) {
                            var l = d.list[f]
                            if (null != l.Bi) {
                              var m = d.position.subarray(
                                  l.Bi[0],
                                  l.Bi[0] + l.Bi[1]
                                ),
                                p = d.normal.subarray(
                                  l.Bi[0],
                                  l.Bi[0] + l.Bi[1]
                                ),
                                r = d.color.subarray(
                                  l.Bi[0],
                                  l.Bi[0] + l.Bi[1]
                                ),
                                q = d.uv.subarray(l.Bi[2], l.Bi[2] + l.Bi[3])
                              a._0x1AIns2(l, m, p, r, q)
                            }
                          }
                        }
                        k++
                        c.value = (100 * k) / g
                        document.getElementById('progressInfo').innerHTML =
                          '\u9996\u6b21\u4e0b\u8f7d\u89e3\u6790Instance...' +
                          k.toString() +
                          '/' +
                          g.toString()
                        h--
                        b.worker && (b.worker.terminate(), (b.worker = null))
                      }
                    })(d)
                    d = { worker: d.worker }
                  }
                  10 <= h &&
                    console.log(
                      '--debuger--\u7ebf\u7a0b\u5df2\u8fbe\u4e0a\u9650\u3002'
                    )
                }, 200),
                r = setInterval(function () {
                  k == g &&
                    (clearInterval(r),
                    console.log('instance-count:' + a._0x3D.length),
                    d(1))
                }, 200)
            })
          }
          if (g) throw g
          c.value = 0
          a.showLog('start \u89e3\u538b\u6a21\u578b')
          var p = new JSZip(h).file('5d.json')
          a.showLog('start \u53cd\u5e8f\u5217\u5316\u6784\u4ef6')
          var m = JSON.parse(p.asText())
          a._0xA06
            .transaction(['ssn'], 'readwrite')
            .objectStore('ssn')
            .add({ id: a._0x4Di + '-3d', values: m })
          p = h = null
          ;(function () {
            JSZipUtils.getBinaryContent(b + '/data.gz', {
              callback: function (b, c) {
                if (b) throw b
                var d = new JSZip(c).file('data.json'),
                  d = JSON.parse(d.asText())
                a._0x3C = d
                a._0xA06
                  .transaction(['ssn'], 'readwrite')
                  .objectStore('ssn')
                  .add({ id: a._0x4Di + '-data', values: d })
                a._0x3C.Cmps = []
                file2 = null
                a._0xC2(0)
                console.log('\u6570\u636e\u5ef6\u8fdf\u52a0\u8f7d\u5b8c\u6210')
              },
            })
          })()
          a._0x1DSrc = m.Mtrs
          for (p = a.mfi = 0; p < a._0x1DSrc.length; p++)
            a._0x2F(a._0x1D, a._0x1DSrc[p], p)
          var q = setInterval(function () {
            a._0x1DSrc.length == a.mfi &&
              (clearInterval(q),
              m.Instances && 0 < m.Instances.length
                ? l().then(function (a) {
                    k()
                  })
                : k())
          }, 1e3)
          a._0xB5 = m.SourcePoint
        },
        progress: function (a) {
          100 > a.percent
            ? ((c.value = a.percent),
              (document.getElementById('progressInfo').innerHTML =
                Math.round(a.percent).toString() +
                '%\uff0c\u9996\u6b21\u6253\u5f00\u4e0b\u8f7d\u4e2d...' +
                Math.round(a.loaded / 1024).toString() +
                '/' +
                Math.round(a.total / 1024).toString() +
                'Kb'))
            : (document.getElementById('progressInfo').innerHTML =
                '\u89e3\u6790\u4e2d...')
        },
      })
    })
  },
  _0xC1l: function () {
    var a = this,
      b = a._0x4D
    this.propertyTable = document.getElementById('treeTable1')
    var c = document.getElementById('progressLoad'),
      d = document.getElementById('progressDiv')
    a.log_face_count = 0
    return new Promise(function (f, k) {
      d.style.display = 'block'
      a.showLog('start \u4e0b\u8f7d\u6a21\u578b')
      ;-1 < [2, 3].indexOf(a.mversion) && (b += '/default.zip')
      JSZipUtils.getBinaryContent(b, {
        callback: function (b, h) {
          function g(b, c) {
            return new Promise(function (d, f) {
              var g = c.file('data-' + b + '.json'),
                g = JSON.parse(g.asText())
              a._0xA06
                .transaction(['ssn'], 'readwrite')
                .objectStore('ssn')
                .add({ id: a._0x4Di + '-data-' + b, values: g })
              a._0x3C.Cmps.push.apply(a._0x3C.Cmps, g)
              d('1')
            })
          }
          function k(b, c, d) {
            return new Promise(function (d, f) {
              console.log(b)
              var g = c.file('3d-' + b + '.json'),
                g = JSON.parse(g.asText())
              a._0xA06
                .transaction(['ssn'], 'readwrite')
                .objectStore('ssn')
                .add({ id: a._0x4Di + '-3d-' + b, values: g })
              for (var k = null, h = 0; h < g.length; h++) {
                var l = g[h],
                  m = g[h].DocId + ':' + g[h].LevelId + ':' + g[h].CatId,
                  n = a.mpacate.get(m)
                n ? n++ : (n = 1)
                a.mpacate.set(m, n)
                l.isPublic || (l.isInstance && l.UniqueId != l.InstanceId)
                  ? k.UniqueId == l.InstanceId || k.UniqueId == l.PublicId
                    ? a._0x1Av4(l, k)
                    : console.log('\u5f02\u5e38\u6784\u4ef6')
                  : (k = a._0x1Av4(l))
              }
              d('1')
            })
          }
          function p() {
            var b = u.GroupCount,
              g = 0
            a.stopRander = !0
            for (var h = 0; h < u.GroupCount; h++)
              (function (d) {
                setTimeout(function () {
                  c.value = (100 * d) / b
                  document.getElementById('progressInfo').innerHTML =
                    '\u89e3\u6790\u4e2d...' + d.toString() + '/' + b.toString()
                  k(d, m, a.mversion)
                  g++
                }, 10 * d)
              })(h)
            var l = setInterval(function () {
              g == b &&
                (clearInterval(l),
                a.showLog(
                  '\u6784\u4ef6\u6570\u91cf\u4e3a\uff1a' +
                    a.sceneGroup.children.length
                ),
                a.showLog('Face\u6570\u91cf\u4e3a\uff1a' + a.log_face_count),
                (document.getElementById('infoCompCount').innerHTML =
                  a.sceneGroup.children.length),
                (document.getElementById('infoAngleCount').innerHTML =
                  a.log_face_count),
                (document.getElementById('infoPointCount').innerHTML =
                  3 * a.log_face_count),
                (d.style.display = 'none'),
                a._0xA06
                  .transaction(['ssn'], 'readwrite')
                  .objectStore('ssn')
                  .add({ id: a._0x4Di + '-all', values: 'ok' }),
                (document.body.background = ''),
                f('1'),
                (a.stopRander = !1))
            }, 1e3)
          }
          if (b) throw b
          c.value = 0
          a.showLog('start \u89e3\u538b\u6a21\u578b')
          var m = new JSZip(h),
            q = m.file('3d.json'),
            r = m.file('data.json')
          a.showLog('start \u53cd\u5e8f\u5217\u5316\u6784\u4ef6')
          var u = JSON.parse(q.asText())
          a._0xA06
            .transaction(['ssn'], 'readwrite')
            .objectStore('ssn')
            .add({ id: a._0x4Di + '-3d', values: u })
          q = h = null
          setTimeout(function () {
            var b = JSON.parse(r.asText())
            a._0x3C = b
            a._0xA06
              .transaction(['ssn'], 'readwrite')
              .objectStore('ssn')
              .add({ id: a._0x4Di + '-data', values: b })
            a._0x3C.Cmps = []
            r = null
            a._0xC2(0)
            setTimeout(function () {
              for (var b = 0; b < a._0x3C.GroupCount; b++) g(b, m)
            }, 1)
            console.log('\u6570\u636e\u5ef6\u8fdf\u52a0\u8f7d\u5b8c\u6210')
          }, 100)
          if (-1 < [3, 4].indexOf(a.mversion))
            for (a._0x1DSrc = u.Mtrs, q = a.mfi = 0; q < a._0x1DSrc.length; q++)
              a._0x2F(a._0x1D, a._0x1DSrc[q], q)
          var v = setInterval(function () {
            if (a._0x1DSrc.length == a.mfi) {
              clearInterval(v)
              if (u.Instances && 0 < u.Instances.length) {
                a._0x3D = []
                for (var b = 0; b < u.Instances.length; b++)
                  a._0x1AIns(u.Instances[b])
              }
              p()
            }
          }, 1e3)
          a._0xB5 = u.SourcePoint
        },
        progress: function (a) {
          100 > a.percent
            ? ((c.value = a.percent),
              (document.getElementById('progressInfo').innerHTML =
                Math.round(a.percent).toString() +
                '%\uff0c\u9996\u6b21\u6253\u5f00\u4e0b\u8f7d\u4e2d...' +
                Math.round(a.loaded / 1024).toString() +
                '/' +
                Math.round(a.total / 1024).toString() +
                'Kb'))
            : (document.getElementById('progressInfo').innerHTML =
                '\u89e3\u6790\u4e2d...')
        },
      })
    })
  },
  _0x2F: function (a, b, c) {
    var d = this
    c *= 5
    var f = parseInt(b[0])
    8450288 < f && (f -= 4210752)
    6291456 >= f && (f += 4210752)
    b[0] = f
    if ('null' == b[2] || '' == b[2]) {
      var k = new THREE.q7({
        color: f,
        vertexColors: THREE.fc,
        transparent: !0,
        side: THREE.ds,
      })
      k.polygonOffset = !0
      k.polygonOffsetFactor = 0.1 * c
      k.polygonOffsetUnits = 2
      d.mfi += 1
      0 < parseInt(b[1]) && (k.opacity = 0.01 * (100 - parseInt(b[1])))
      a.push(k)
      k.mgr_0x6s = []
      k.mgrObjs = []
    } else {
      var g = a.length,
        k = new THREE.q7({
          color: f,
          vertexColors: THREE.fc,
          transparent: !0,
          side: THREE.ds,
        })
      k.polygonOffset = !0
      k.polygonOffsetFactor = 0.1 * c
      k.polygonOffsetUnits = 2
      0 < parseInt(b[1]) && (k.opacity = 0.01 * (100 - parseInt(b[1])))
      k.mgr_0x6s = []
      k.mgrObjs = []
      a.push(k)
      '0' == b[4] && (b[4] = '1')
      '0' == b[3] && (b[3] = b[4])
      var h = b[3],
        n = b[4],
        l = b[5],
        p = b[6]
      new THREE.q6().load(d.net._0xA09_new(b[2]), function (b) {
        var k = new THREE.q7({
          map: b,
          color: f,
          vertexColors: THREE.fc,
          transparent: !0,
          side: THREE.ds,
        })
        k.wa = l
        k.ha = p
        k.polygonOffset = !0
        k.polygonOffsetFactor = -0.1 * c
        k.polygonOffsetUnits = 2
        k.wsa = parseFloat(h)
        k.hsa = parseFloat(n)
        k.mgr_0x6s = []
        k.mgrObjs = []
        a[g] = k
        d.mfi += 1
        b.wrapS = b.wrapT = THREE.RepeatWrapping
        b.repeat = new THREE.vt2(5, 5)
      })
    }
  },
  _0xC3: function (a) {
    var b = this
    this._0x4D = a
    this.propertyTable = document.getElementById('treeTable1')
    var c = document.getElementById('progressDiv')
    b.log_face_count = 0
    return new Promise(function (d, f) {
      c.style.display = 'block'
      b.showLog('start \u4e0b\u8f7d\u6a21\u578b')
      var k = function (a) {
          a.lengthComputable &&
            console.log(
              Math.round((a.loaded / a.total) * 100, 2) + '% downloaded'
            )
        },
        g = function () {}
      THREE.Loader.Handlers.add(/\.dds$/i, new THREE.DDSLoader())
      new THREE.MTLLoader().load(a + '.mtl', function (c) {
        c.preload()
        new THREE.OBJLoader().setMaterials(c).load(
          a + '.obj',
          function (a) {
            a.position.y = -95
            b.sceneGroup.add(a)
            d('1')
          },
          k,
          g
        )
      })
      c.style.display = 'none'
    })
  },
  _0x3F: function (a) {
    var b = this
    this._0x4D = a
    this.propertyTable = document.getElementById('treeTable1')
    var c = document.getElementById('progressDiv')
    b.log_face_count = 0
    return new Promise(function (d, f) {
      c.style.display = 'block'
      b.create_0x0F()
      $.getJSON(a, function (a) {
        file1 = null
        b._0x3C = a
        b._0xC2Su()
        for (var f = 0; f < a.nas.length; f++) b.addnas(a.nas[f], f)
        c.style.display = 'none'
        d('1')
        document.body.background = ''
        this.onChangeCallBack
      })
    })
  },
  _0x3Fdwg: function (a) {
    return new Promise(function (b, c) {
      progressDiv.style.display = 'block'
      _this.create_0x0F()
      $.getJSON(a, function (a) {
        file1 = null
        _this._0x3C = a
        _this._0xC2Su()
        for (var c = 0; c < a.nas.length; c++) _this.addnas(a.nas[c], c)
        progressDiv.style.display = 'none'
        b('1')
        document.body.background = ''
        this.onChangeCallBack
      })
    })
  },
  _0xC2Su: function () {
    var a = this,
      b = this
    document.getElementById('divBfTree').innerHTML = ''
    var c = new TreeNode('\u5168\u90e8\u5206\u7c7b', b, 0, 0, !1)
    document.getElementById('divBfTree').appendChild(c.element)
    var d = new TreeNode('\u94bb\u5b54\u4f4d\u7f6e', b, 'BH', 1, !0)
    c.addChildNode(d)
    b._0x3C.LevelComps.forEach(function (a) {
      a = new TreeNode(a.ZNames, b, a.ZNames, 1, !0)
      c.addChildNode(a)
    })
    b._0x3C.Mps.forEach(function (c) {
      var d = [],
        f = new THREE.q7({
          color: 16711680,
          vertexColors: THREE.fc,
          transparent: !0,
          side: THREE.ds,
          wireframe: !1,
        })
      d.push(f)
      d = new THREE.na(b._0x0F, d)
      d.position.set(c.X, c.Y, c.Z)
      d.rid = c.BH
      d.catid = c.BH
      d.lid = 'BH'
      d.docid = 'BH'
      d.UniqueId = c.BH
      a.sceneGroup.add(d)
    })
    this._0x7E = c
  },
  lck: function (a, b, c) {
    ;(a = this.mpacate.get(a + ':' + b + ':' + c)) || (a = 0)
    return a
  },
  _0xC2: function (a) {
    var b = this,
      c = this
    document.getElementById('divBfTree').innerHTML = ''
    var d = new TreeNode('\u5168\u90e8\u5206\u7c7b', c, 0, 0, !1)
    document.getElementById('divBfTree').appendChild(d.element)
    if (0 == a)
      if (1 < this._0x3C.DocNames.length)
        for (
          var f = {}, k = 0;
          k < this._0x3C.DocNames.length;
          f = { _docId: f._docId }, k++
        ) {
          var g = new TreeNode(this._0x3C.DocNames[k], c, k, 4, !0)
          d.addChildNode(g)
          f._docId = k
          this._0x3C.Levels.forEach(
            (function (a) {
              return function (d) {
                if (a._docId == d.DocId) {
                  var f = new TreeNode(d.Name, c, d.Id, 1, !0)
                  g.addChildNode(f)
                  var k = d.Id
                  b._0x3C.Symbles.forEach(function (b) {
                    if (a._docId == b.DocId) {
                      var d = c.lck(a._docId, k, b.Id)
                      0 < d &&
                        ((d = new TreeNode(
                          b.text + '[' + d + ']',
                          c,
                          b.Id,
                          3,
                          !0
                        )),
                        f.addChildNode(d),
                        -1 < c.defaultHideTypes.indexOf(b.Id) && d.doUncheck())
                    }
                  })
                }
              }
            })(f)
          )
        }
      else
        this._0x3C.Levels.forEach(function (a) {
          var f = new TreeNode(a.Name, c, a.Id, 1, !0)
          d.addChildNode(f)
          var g = a.Id
          b._0x3C.Symbles.forEach(function (a) {
            var b = c.lck(0, g, a.Id)
            0 < b &&
              ((a = new TreeNode(a.text + '[' + b + ']', c, a.Id, 3, !0)),
              f.addChildNode(a))
          })
        })
    1 == a
      ? this._0x3C.Symbles.forEach(function (a) {
          a = new TreeNode(a.text, c, a.Id, 3, !0)
          d.addChildNode(a)
        })
      : 2 == a &&
        this._0x3C.Levels.forEach(function (a) {
          a = new TreeNode(a.Name, c, a.Id, 1, !0)
          d.addChildNode(a)
        })
    this._0x7E = d
  },
  _0x1EFun: function () {
    this._0xA04.expandByObject(this.sceneGroup)
    this._0xA04.getCenter(this._0xA05)
    console.log(a)
    1e4 < a &&
      ((a = new THREE.b7()),
      a.expandByObject(this.sceneGroup.children[5]),
      a.getCenter(this._0xA05),
      (this._0xA04 = a))
    var a = this._0xA04.max.distanceTo(this._0xA05),
      a = 1.8 * a
    this._0x00(
      this._0x9B.position,
      { x: this._0xA05.x + a, y: this._0xA05.y + a, z: this._0xA05.z + a },
      this._0x6E.target,
      { x: this._0xA05.x, y: this._0xA05.y, z: this._0xA05.z }
    )
  },
  _0xD1: function () {
    this._0x1EFun()
    this._0x0A()
    this._0xE1()
    this._0xD2()
    this._0x1C = document.getElementById('container').getBoundingClientRect()
    this._0x0D = new THREE.rct()
    this._0x0D.linePrecision = 3
    this._0x0E = new THREE.Group()
    this._0x0B.add(this._0x0E)
    console.log('this._0x2C.info', this._0x2C.info)
    this._0x2D = new THREE.q7({
      color: 12582924,
      vertexColors: THREE.fc,
      transparent: !1,
      side: THREE.ds,
      opacity: 1,
      wireframe: !1,
    })
  },
  _0xD2: function () {
    var a = this
    this._0x6E.addEventListener('end', function () {
      a._0xF9()
      _0x8C = setTimeout(_0xF8, 10)
    })
    this._0x6E.addEventListener('start', function () {
      clearTimeout(_0x8C)
    })
  },
  _0xD3: function () {
    return this._0x7D
  },
  _0xD4: function () {
    ;(this._0x7D = !this._0x7D)
      ? ((this._0xB4 = new THREE.sb1(this._0x9B, this._0x0B)),
        (this._0x6D = new THREE.sbh(this._0xB4, this._0x2C, 'selectBox')),
        (this._0x6E.enabled = !1))
      : ((this._0x6D = this._0xB4 = null), (this._0x6E.enabled = !0))
  },
  setAddEdgeLine: function (a) {
    this._0x9C = a
  },
  setMGR: function (a) {
    this.mgr = a
  },
  setMeasure: function () {
    this._0x8D = !this._0x8D
    this._0x9D = null
    this._0x6E.enabled = this._0x8D ? !1 : !0
  },
  getnaById: function (a) {
    for (var b in this.sceneGroup.children)
      if (this.sceneGroup.children.hasOwnProperty(b)) {
        var c = this.sceneGroup.children[b]
        if (c.UniqueId === a) {
          if ('na' == c.type) return c
          if ('LOD' == c.type)
            for (var d in c.children)
              if (c.children.hasOwnProperty(d)) {
                var f = c.children[d]
                if (f.visible) return f
              }
        }
      }
  },
  getnaByIdv2: function (a) {
    a = this.qmidmap.get(a)
    if (null == a) return null
    a = this.qmlist.get(a)
    return null == a ? null : a
  },
  getIdOfna: function (a) {
    return a.UniqueId
  },
  _0xD5: function () {
    return this._0x7D ? this._0xB4.collection : this._0x5A
  },
  _0xC4: function () {
    for (var a = [], b = 0; b < this._0x5D.length; b++)
      (e = this._0x5D[b]),
        null != e.insId
          ? a.push(
              e.mesh.meshList[e.insId].Di + '^' + e.mesh.meshList[e.insId].Ui
            )
          : a.push(e.mesh.docid + '^' + e.mesh.UniqueId)
    return a
  },
  _0xC8: function (a) {
    var b = []
    if (a)
      for (var c = 0; c < a.length; c++)
        ('na' != a[c].type && 'LOD' != a[c].type) || b.push(a[c].UniqueId)
    return b
  },
  _0xD6: function (a, b) {
    a.forEach(function (a) {
      if ('na' == a.type || 'LOD' == a.type) a.visible = b
    })
  },
  _0xC7: function (a, b) {
    console.log(a)
    var c
    this.setSelect([])
    for (var d = 0; d < a.length; d++)
      if ((c = this.qmidmap.get(a[d])))
        (c = this.qmlist.get(c)),
          null != c.insId ? c.mesh._013(c.insId, b) : (c.mesh.visible = b)
    this.onChangeCallBack()
  },
  _0xC7map: function (a, b) {
    if (this._012) {
      this.setSelect([])
      for (
        var c = $jscomp.makeIterator(a.entries()), d = c.next();
        !d.done;
        d = c.next()
      )
        if (
          ((d = $jscomp.makeIterator(d.value)),
          d.next(),
          (d = d.next().value),
          (t = this.qmidmap.get(d)))
        )
          (t = this.qmlist.get(t)),
            null != t.insId ? t.mesh._013(t.insId, b) : (t.mesh.visible = b)
    } else
      this.sceneGroup.children.forEach(function (c) {
        ;('na' != c.type && 'LOD' != c.type) ||
          !a.has(c.UniqueId) ||
          (c.visible = b)
      })
    this.onChangeCallBack()
  },
  setSelectCallback: function (a) {
    this._0xB8 = a
  },
  _0xD7: function (a, b) {
    var c = this
    a.forEach(function (a) {
      'na' == a.type && (b ? c._0xC61(a, b) : c._0xC61(a, null))
    })
  },
  _0xC6: function (a, b) {
    var c = this
    this.sceneGroup.children.forEach(function (d) {
      'na' == d.type &&
        -1 < a.indexOf(d.UniqueId) &&
        (b ? c._0xC61(d, b) : c._0xC61(d, null))
    })
  },
  _0xC61: function (a, b) {
    var c = null
    b &&
      ((a.backMtr = []),
      (c = new THREE.q7({
        color: b,
        vertexColors: THREE.fc,
        transparent: !0,
        side: THREE.ds,
        wireframe: !1,
      })),
      (a.userMtr = c))
    for (var d = 0; d < a.material.length; d++)
      b
        ? (a.backMtr.push(a.material[d]), (a.material[d] = c))
        : (a.material = a.backMtr)
  },
  _0xD8: function (a, b) {
    var c = this
    a.forEach(function (a) {
      ;('na' != a.type && 'LOD' != a.type) || c._0xD9(a, b)
    })
  },
  _0xC5: function (a, b) {
    var c = this
    this._012
      ? alert('\u6b64\u529f\u80fd\u6b63\u5728\u4f18\u5316')
      : this.sceneGroup.children.forEach(function (d) {
          if (-1 < a.indexOf(d.UniqueId))
            if ('na' == d.type) c._0xD9(d, b)
            else if ('LOD' == d.type)
              for (var f in d.children)
                if (d.children.hasOwnProperty(f)) {
                  var k = d.children[f]
                  k.visible && c._0xD9(k, b)
                }
        })
  },
  _0xD9: function (a, b) {
    a.material.forEach(function (a) {
      a.transparent = 1 != b
      a.opacity = b
    })
  },
  _0xD10: function (a) {
    this._0xD6ByTree(-1, 0, 0, !a)
    this.onChangeCallBack()
  },
  _0xE1: function () {
    this._0x3B = new THREE.Group()
    this._0x3B.add(new THREE.q8(this._0x2E[0], 20, 16711680))
    this._0x3B.add(new THREE.q8(this._0x2E[1], 20, 65280))
    this._0x3B.add(new THREE.q8(this._0x2E[2], 20, 255))
    this._0x3B.add(new THREE.q8(this._0x2E[3], 20, 16711680))
    this._0x3B.add(new THREE.q8(this._0x2E[4], 20, 65280))
    this._0x3B.add(new THREE.q8(this._0x2E[5], 20, 255))
    this._0x3B.visible = !1
    this._0xE3(this._0xA05)
    this._0x0B.add(this._0x3B)
    this._0xB6 = [
      [this._0x2E[0]],
      [this._0x2E[1]],
      [this._0x2E[2]],
      [this._0x2E[3]],
      [this._0x2E[4]],
      [this._0x2E[5]],
    ]
    this._0x2C.clippingpls = this.Empty
    this._0x2C.localClippingEnabled = !0
  },
  _0xE2: function (a) {
    this._0x3B.visible = a
    this.onChangeCallBack()
  },
  _0xE3: function (a) {
    a &&
      !this._0x6C &&
      this._0x3B.children.forEach(function (b) {
        b.position.set(a.x, a.y, a.z)
      })
  },
  SetClipVisible: function (a) {
    var b = this._0xB6[a][0],
      c = this._0xB7.lastIndexOf(b)
    ;-1 === c
      ? (this._0xB7.push(b),
        (this._0x4C.Value = b.constant),
        (this._0x4C.ClipIndex = a))
      : this._0xB7.splice(c, 1)
    this._0x4C.Enable = 0 < this._0xB7.length
    this._0x2C.clippingpls = this._0xB7
    this.onChangeCallBack()
  },
  _0xE4: function (a, b) {
    var c = this._0xB6[a][0]
    this._0x4C.ClipIndex = a
    var d = 0
    5 == a
      ? ((d = this._0xA05.z),
        (d =
          ((parseInt(b) - 50) / 100) * (this._0xA04.max.z - this._0xA04.min.z) +
          d))
      : 2 == a
      ? ((d = this._0xA05.z),
        (d =
          -1 *
          (((parseInt(b) - 50) / 100) *
            (this._0xA04.max.z - this._0xA04.min.z) +
            d)))
      : 4 == a
      ? ((d = this._0xA05.y),
        (d =
          1 *
          (((parseInt(b) - 50) / 100) *
            (this._0xA04.max.y - this._0xA04.min.y) +
            d)))
      : 1 == a
      ? ((d = this._0xA05.y),
        (d =
          -1 *
          (((parseInt(b) - 50) / 100) *
            (this._0xA04.max.y - this._0xA04.min.y) +
            d)))
      : 3 == a
      ? ((d = this._0xA05.x),
        (d =
          -1 *
          (((parseInt(b) - 50) / 100) *
            (this._0xA04.max.x - this._0xA04.min.x) +
            d)))
      : 0 == a &&
        ((d = this._0xA05.x),
        (d =
          -1 *
          (((parseInt(b) - 50) / 100) *
            (this._0xA04.max.x - this._0xA04.min.x) +
            d)))
    this._0x4C.Value = d
    c.constant = d
    this.onChangeCallBack()
  },
  _0xD8ByTree: function (a, b, c) {
    var d = this
    0 == b && 0 == a
      ? this.sceneGroup.children.forEach(function (a) {
          ;('na' != a.type && 'LOD' != a.type) || d._0xD9(a, c)
        })
      : 1 != b && 0 != a
      ? this.sceneGroup.children.forEach(function (f) {
          ;('na' != f.type && 'LOD' != f.type) ||
            a != f.catid ||
            f.lid !== b ||
            d._0xD9(f, c)
        })
      : 0 == b
      ? this.sceneGroup.children.forEach(function (b) {
          ;('na' != b.type && 'LOD' != b.type) || b.catid !== a || d._0xD9(b, c)
        })
      : 0 == a &&
        this.sceneGroup.children.forEach(function (a) {
          ;('na' != a.type && 'LOD' != a.type) || a.lid !== b || d._0xD9(a, c)
        })
    this.onChangeCallBack()
  },
  _0xD6ByTree: function (a, b, c, d) {
    var f = !d
    if (-1 == a && 0 == b && 0 == c)
      this.qmtree.forEach(function (a, b) {
        a.forEach(function (a, b) {
          a.forEach(function (a, b) {
            a.forEach(function (a, b) {
              null != a.insId ? a.mesh._013(a.insId, f) : (a.mesh.visible = f)
            })
          })
        })
      })
    else if (-1 < a && 0 != b && 0 != c) {
      a = this.qmtree.get(a)
      if (!a) return
      a = a.get(b)
      if (!a) return
      a = a.get(c)
      if (!a) return
      a.forEach(function (a, b) {
        null != a.insId ? a.mesh._013(a.insId, f) : (a.mesh.visible = f)
      })
    } else if (-1 < a && 0 != b && 0 == c) {
      a = this.qmtree.get(a)
      if (!a) return
      a = a.get(b)
      if (!a) return
      a.forEach(function (a, b) {
        a.forEach(function (a, b) {
          null != a.insId ? a.mesh._013(a.insId, f) : (a.mesh.visible = f)
        })
      })
    } else if (-1 < a && 0 == b && 0 == c) {
      a = this.qmtree.get(a)
      if (!a) return
      a.forEach(function (a, b) {
        a.forEach(function (a, b) {
          a.forEach(function (a, b) {
            null != a.insId ? a.mesh._013(a.insId, f) : (a.mesh.visible = f)
          })
        })
      })
    }
    this.onChangeCallBack()
  },
  _0xE7: function () {
    return JSON.stringify({
      eye: this._0x9B.position,
      center:
        0 < this._0x7C.length
          ? this._0x7C[0].position
          : [this._0x6E.target.x, this._0x6E.target.y, this._0x6E.target.z],
      up: this._0x9B.up,
      rotation: this._0x9B.rotation,
      target: this._0x6E.target,
    })
  },
  _0xE8: function (a) {
    a = JSON.parse(a)
    this._0x00(this._0x9B.position, a.eye, this._0x6E.target, {
      x: a.center[0],
      y: a.center[1],
      z: a.center[2],
    })
    this._0x9B.rotation.set(a.rotation._x, a.rotation._y, a.rotation._z, 'XYZ')
    this.onChangeCallBack()
  },
  _0xE9: function (a, b) {
    this._0x5C = a
    this._0x5CCl = b
  },
  _0xE10: function (a, b, c) {
    if (b) {
      var d = this._0x2B(b[0], b[1], b[2])
      this._0xF4(d, b, a, c)
    } else (d = this._0x2B(b[0], b[1], b[2])), this._0xF4(d, b, a)
  },
  _0xF2: function () {
    for (var a = [], b = 0; b < this._0x7C.length; b++) {
      var c = this._0x7C[b]
      a.push({ rid: c.meshRid, position: c.position })
    }
    return JSON.stringify(a)
  },
  _0xF3: function (a, b) {
    var c = this
    JSON.parse(a).forEach(function (a) {
      c._0xE10(a.rid, a.position, b)
    })
    this.onChangeCallBack()
  },
  _0xF4: function (a, b, c, d) {
    var f = document.createElement('div')
    f.classList.add('xk-3d-hotspot')
    f.style.position = 'absolute'
    f.Name = 'Mark' + c
    var k = this
    f.onclick = function (a) {
      if (k._0xB9) {
        var b = null
        a = a.target.parentNode.Name
        4 < a.length && (b = a.substr(4, a.length - 4))
        k._0xB9(b)
      }
    }
    document.body.appendChild(f)
    f.innerHTML = d
      ? ' \x3cdiv class\x3d"hotspot-border"\x3e\x3cdiv class\x3d"arrow outer"\x3e\x3c/div\x3e\x3cdiv class\x3d"arrow inner"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan\x3e' +
        d +
        '\x3c/span\x3e\x3c/div\x3e'
      : '\x3cimg src\x3d"css/led_red.png" class\x3d"zoom" style\x3d"position: absolute;"\x3e'
    f.style.display = ''
    f.style.left = a.x - 16 + 'px'
    f.style.top = a.y - 16 + 'px'
    this._0x7C.push({ position: b, mark: f, meshRid: c })
  },
  _0xF4Mr: function (a, b) {
    var c = this._0x2B(a.x, a.y, a.z),
      d = document.createElement('div')
    d.style.position = 'absolute'
    d.Name = 'Mark' + JSON.stringify(a)
    document.body.appendChild(d)
    d.innerHTML = b
    d.style.color = '#ffd700'
    d.style.display = ''
    d.style.left = c.x - 16 + 'px'
    d.style.top = c.y - 16 + 'px'
    this._0x7C.push({ position: [a.x, a.y, a.z], mark: d, meshRid: -1 })
  },
  set_0xB9: function (a) {
    this._0xB9 = a
  },
  _0xF5: function (a) {
    for (var b = -1, c = 0; c < this._0x7C.length; c++) {
      var d = this._0x7C[c]
      if (d.meshRid == a) {
        document.body.removeChild(d.mark)
        b = c
        break
      }
    }
    ;-1 < b && (this._0x7C = this._0x7C.splice(b, 1))
  },
  _0xF6: function (a) {
    this._0xF5(a.rid)
  },
  _0xF7: function () {
    for (var a = 0; a < this._0x7C.length; a++)
      document.body.removeChild(this._0x7C[a].mark)
    this._0x7C = []
    this.onChangeCallBack()
  },
  _0xF8: function () {
    var a = this
    this._0x7C.forEach(function (b) {
      var c = b.mark
      b = a._0x2B(b.position[0], b.position[1], b.position[2])
      c.style.display = ''
      c.style.left = b.x - 16 + 'px'
      c.style.top = b.y - 16 + 'px'
    })
  },
  _0xF9: function () {
    this._0x7C.forEach(function (a) {
      a.mark.style.display = 'none'
    })
  },
  showLog: function (a) {
    console.log(a)
  },
  _0xF10: function (a) {
    this._0x2C = a
  },
  getRenderer: function () {
    return this._0x2C
  },
  _0x0A: function () {
    var a = new THREE.q10(14737632, 0.6)
    this._0x0B.add(a)
    a = new THREE.HemisphereLight(15658734, 11184810, 1)
    this._0x0B.add(a)
    a = new THREE.q9(16777215, 0.8)
    a.position.set(this._0xA05.x, this._0xA05.y + 800, this._0xA05.z + 800)
    this._0x0B.add(a)
  },
  _009: function (a, b, c, d) {
    var f = null != a.Di ? a.Di : a.DocId,
      k = this.qmtree.get(f)
    null == k && ((k = new Map()), this.qmtree.set(f, k))
    var f = null != a.Li ? a.Li : a.LevelId,
      g = k.get(f)
    null == g && ((g = new Map()), k.set(f, g))
    f = null != a.Ci ? a.Ci : a.CatId
    k = g.get(f)
    null == k && ((k = new Map()), g.set(f, k))
    f = d
    null != c && (f = f + '^' + c.toString())
    k.set(f, { obj: a, mesh: b, insId: c })
    this.qmlist.set(f, { obj: a, mesh: b, insId: c })
    this.qmidmap.set(
      (null != a.Di ? a.Di : a.DocId) + '^' + (a.Ui ? a.Ui : a.UniqueId),
      f
    )
  },
  _0x1A: function (a) {
    var b = [],
      c = [],
      d = []
    a.Colors.forEach(function (a) {
      var b = new THREE.q7({
        color: a[0],
        vertexColors: THREE.fc,
        transparent: !0,
        side: THREE.ds,
        wireframe: !1,
      })
      0 < a[1] && (b.opacity = 0.01 * (100 - a[1]))
      d.push(b)
    })
    for (var f = 0; f < a.Vertices.length; f++) {
      var k = a.Vertices[f].split(',')
      b.push(new THREE._0x1(a.xs[k[0]], a.ys[k[1]], a.zs[k[2]]))
    }
    for (f = 0; f < a.Faces.length; f++) {
      var k = a.Faces[f].split(','),
        g = new THREE._0x4(k[0], k[1], k[2])
      g.color.setHex(a.Colors[k[3]][0])
      g.materialIndex = k[3]
      c.push(g)
    }
    this.log_face_count += a.Faces.length
    f = new THREE._0x6()
    f.vertices = b
    f.faces = c
    f = new THREE._0x2().from_0x6(f)
    b = new THREE.na(f, d)
    b.position.set(0, 0, 0)
    b.rid = a.Id
    b.catid = a.CatId
    b.lid = a.LevelId
    this._0x9C &&
      ((a = new THREE.Edges_0x6(f, 89)),
      (a = new THREE.b2(a, new THREE.b3({ color: 8421504 }))),
      b.children.push(a))
    this.sceneGroup.add(b)
  },
  _0xA01V2: function (a, b) {
    var c = parseInt(b[0])
    if ('null' == b[2])
      (c = new THREE.q7({
        color: c,
        vertexColors: THREE.fc,
        transparent: !0,
        side: THREE.ds,
        wireframe: !1,
      })),
        0 < parseInt(b[1]) && (c.opacity = 0.01 * (100 - parseInt(b[1]))),
        a.push(c)
    else {
      var d = b[3],
        f = b[4]
      new THREE.q6().load(this._0x4D + '/' + b[2], function (b) {
        var c = new THREE.q7({ map: b })
        c.wa = d
        c.ha = f
        a.push(c)
        b.wrapS = b.wrapT = THREE.RepeatWrapping
        b.repeat = new THREE.vt2(5, 5)
      })
    }
  },
  _0x1AV2: function (a) {
    for (
      var b = [], c = [], d = [], f = [], k = [], g = 0;
      g < a.Colors.length;
      g++
    )
      this._0xA01V2(d, a.Colors[g])
    for (g = 0; g < a.Pt.length; g++) {
      var h = a.Pt[g].split(',')
      b.push(new THREE._0x1(h[0], h[1], h[2]))
    }
    for (var n = 0.254 * 0.1, g = 0; g < a.UVs.length; g++)
      (h = a.UVs[g].split(',')), f.push(new THREE.vt2(h[0] * n, h[1] * n))
    h = 1
    for (g = 0; g < a.Faces.length; g++)
      for (n = 0; n < a.Faces[g].Tgs.length; n++) {
        var l = a.Faces[g].Tgs[n].split(','),
          p = a.Faces[g].Uvset[n].split(','),
          l = new THREE._0x4(l[0], l[1], l[2])
        l.color.setHex(parseInt(a.Colors[a.Faces[g].MtrId][0]))
        l.materialIndex = a.Faces[g].MtrId
        h++
        c.push(l)
        l = []
        l.push(f[p[0]], f[p[1]], f[p[2]])
        k.push(l)
      }
    this.log_face_count += h
    f = new THREE._0x6()
    f.vertices = b
    f.faces = c
    f.faceVertexUvs[0] = k
    f.computeFaceNormals()
    b = new THREE.na(f, d)
    b.position.set(0, 0, 0)
    b.rid = a.Id
    b.catid = a.CatId
    b.lid = a.LevelId
    this._0x9C &&
      ((a = new THREE.Edges_0x6(f, 89)),
      (a = new THREE.b2(a, new THREE.b3({ color: 8421504 }))),
      b.children.push(a))
    this.sceneGroup.add(b)
  },
  _0xA01V3: function (a, b, c) {
    c = parseInt(c)
    a.push(this._0x1D[c])
    b.push(this._0x1DSrc[c])
  },
  _0x1AV3: function (a) {
    var b = [],
      c = [],
      d = [],
      f = [],
      k = [],
      g = [],
      h = null,
      n = null,
      l = 0 < a.UVs.length
    if (a.isInstance && a.InstanceId)
      a: {
        for (h = 0; h < this._0x3D.length; h++)
          if (this._0x3D[h].id == a.InstanceId) {
            h = this._0x3D[h]
            break a
          }
        h = null
      }
    if (h)
      (f = h.go),
        (d = h.mt),
        (n = new THREE.Matrix4()),
        (n.elements = a.transform)
    else {
      for (h = 0; h < a.Colors.length; h++) this._0xA01V3(d, f, a.Colors[h])
      for (h = 0; h < a.Pt.length; h++) {
        var p = a.Pt[h].split(',')
        b.push(new THREE._0x1(p[0], p[1], p[2]))
      }
      if (l) {
        var m = 0.127,
          q = m
        1 == d.length &&
          (d[0].ha && d[0].hsa && (q = (12 / d[0].hsa) * 0.22),
          d[0].wa && d[0].wsa && (m = (12 / d[0].wsa) * 0.2))
        for (h = 0; h < a.UVs.length; h++)
          (p = a.UVs[h].split(',')), k.push(new THREE.vt2(p[0] * m, p[1] * q))
      }
      p = 1
      for (h = 0; h < a.Faces.length; h++)
        for (m = 0; m < a.Faces[h].Tgs.length; m++) {
          var r = a.Faces[h].Tgs[m].split(',')
          if ((q = 0 < a.Faces[h].Uvset.length && a.Faces[h].Uvset[m]))
            var u = a.Faces[h].Uvset[m].split(',')
          r = new THREE._0x4(r[0], r[1], r[2])
          r.color.setHex(parseInt(f[a.Faces[h].MtrId][0]))
          r.materialIndex = a.Faces[h].MtrId
          p++
          c.push(r)
          l && q
            ? ((q = []), q.push(k[u[0]], k[u[1]], k[u[2]]))
            : ((q = []),
              q.push(
                new THREE.vt2(0, 0),
                new THREE.vt2(0, 0),
                new THREE.vt2(0, 0)
              ))
          g.push(q)
        }
      this.log_face_count += p
      f = new THREE._0x6()
      f.vertices = b
      f.faces = c
      f.faceVertexUvs[0] = l ? g : []
      f.computeFaceNormals()
      f = new THREE._0x2().from_0x6(f)
    }
    b = new THREE.na(f, d)
    b.position.set(0, 0, 0)
    b.rid = a.Id
    b.catid = a.CatId
    b.lid = a.LevelId
    n && b.applyMatrix4(n)
    this.sceneGroup.add(b)
    this._0x9C &&
      ((a = new THREE.Edges_0x6(f, 89)),
      (a = new THREE.b2(a, new THREE.b3({ color: 8421504 }))),
      n && a.applyMatrix4(n),
      b.children.push(a))
  },
  setHexmi: function (a) {
    a = Math.floor(a)
    var b = []
    b.push(((a >> 16) & 255) / 255)
    b.push(((a >> 8) & 255) / 255)
    b.push((a & 255) / 255)
    return b
  },
  _0x2A: function (a, b, c) {
    var d = new THREE._0x1(),
      f = new THREE._0x1()
    a = new THREE._0x1(a[0], a[1], a[2])
    b = new THREE._0x1(b[0], b[1], b[2])
    c = new THREE._0x1(c[0], c[1], c[2])
    d.subVectors(c, b)
    f.subVectors(a, b)
    d.cross(f)
    d.normalize()
    return [d.x, d.y, d.z]
  },
  _0x1Av4: function (a, b) {
    var c = [],
      d = [],
      f = [],
      k = [],
      g = [],
      h = [],
      n,
      l = null,
      p = 0 < a.UVs.length
    n = b
    if (a.isInstance || b) (l = new THREE.Matrix4()), (l.elements = a.transform)
    if (n) (f = n.go), (k = n.mt)
    else {
      for (var m = 0; m < a.Colors.length; m++) this._0xA01V3(k, g, a.Colors[m])
      for (m = 0; m < a.Pt.length; m += 3)
        f.push([a.Pt[m], a.Pt[m + 1], a.Pt[m + 2]]),
          c.push(new THREE._0x1(a.Pt[m], a.Pt[m + 1], a.Pt[m + 2]))
      if (p)
        for (m = 0; m < a.UVs.length; m += 2)
          h.push([0.08 * a.UVs[m], 0.08 * a.UVs[m + 1]]),
            d.push(new THREE.vt2(0.08 * a.UVs[m], 0.08 * a.UVs[m + 1]))
      c = 1
      d = []
      normalss = []
      colorss = []
      uvmi = []
      groups = []
      var q = 0
      a.Faces[0] && a.Faces[0].MtrId && (q = a.Faces[0].MtrId)
      for (var r = 0, m = 0; m < a.Faces.length; m++) {
        var u = null
        a.Faces[m].Nor && (u = a.Faces[m].Nor.split(','))
        var v = g[a.Faces[m].MtrId],
          z = this.setHexmi(parseInt(v[0]))
        q != a.Faces[m].MtrId &&
          (groups.push({ start: y, count: r, materialIndex: q }),
          (q = a.Faces[m].MtrId),
          (y += r),
          (r = 0))
        m == a.Faces.length - 1 &&
          ((r = a.Faces[m].Mgr
            ? r + a.Faces[m].Tgs[1] - a.Faces[m].Tgs[0] + 1
            : r + a.Faces[m].Tgs.length),
          groups.push({ start: y, count: r, materialIndex: q }))
        var r = a.Faces[m].Mgr
            ? r + a.Faces[m].Tgs[1] - a.Faces[m].Tgs[0] + 1
            : r + a.Faces[m].Tgs.length,
          y = 0,
          w,
          x
        a.Faces[m].Mgr
          ? ((w = a.Faces[m].Tgs[0]), (x = a.Faces[m].Tgs[1] + 1))
          : ((w = 0), (x = a.Faces[m].Tgs.length))
        for (; w < x; w += 3) {
          c++
          var A,
            D = null
          A = a.Faces[m].Mgr
            ? [w, w + 1, w + 2]
            : [a.Faces[m].Tgs[w], a.Faces[m].Tgs[w + 1], a.Faces[m].Tgs[w + 2]]
          var E = 0 < a.Faces[m].Uvset.length && a.Faces[m].Uvset[w]
          E &&
            (D = a.Faces[m].Mgr
              ? [w, w + 1, w + 2]
              : [
                  a.Faces[m].Uvset[w],
                  a.Faces[m].Uvset[w + 1],
                  a.Faces[m].Uvset[w + 2],
                ])
          u || (u = this._0x2A(f[A[0]], f[A[1]], f[A[2]]))
          for (var B = 0; 3 > B; B++) {
            for (var C = 0; 3 > C; C++)
              d.push(f[A[B]][C]), normalss.push(u[C]), colorss.push(z[C])
            p && E
              ? (uvmi.push(h[D[B]][0] / v[3]), uvmi.push(h[D[B]][1] / v[4]))
              : (uvmi.push(0), uvmi.push(0))
          }
        }
      }
      f = new THREE._0x2()
      f.setAttribute('position', new THREE._0x3(new Float32Array(d), 3))
      f.setAttribute('normal', new THREE._0x3(new Float32Array(normalss), 3))
      f.setAttribute('color', new THREE._0x3(new Float32Array(colorss), 3))
      f.setAttribute('uv', new THREE._0x3(new Float32Array(uvmi), 2))
      for (g = 0; g < groups.length; g++)
        f.addGroup(groups[g].start, groups[g].count, groups[g].materialIndex)
      this.log_face_count += c
    }
    c = new THREE.na(f, k)
    c.position.set(0, 0, 0)
    c.rid = a.Id
    c.catid = a.CatId
    c.lid = a.LevelId
    c.matrixAutoUpdate = null == n
    c.docid = a.DocId
    this._012 || this.octree.add(c)
    c.UniqueId = a.UniqueId
    l && c.applyMatrix4(l)
    g = new THREE.b7()
    g.setFromObject(c)
    g = new THREE._0x1().addVectors(g.max, g.min).multiplyScalar(0.5)
    if (
      !isNaN(g.x) &&
      ((c.worldDir = new THREE._0x1().subVectors(g, this._0xA05).normalize()),
      (c.userData.oldPs = c.getWorldPosition(new THREE._0x1())),
      f.computeBoundingSphere(),
      (g = f.boundingSphere),
      (c.mycenter = g.center),
      (c.myRadius = g.radius),
      l && c.mycenter.applyMatrix4(l),
      50 < a.tngCount && 2 > g.radius
        ? ((h = new THREE.Sphere_0x6(g.radius / 2, 3, 3)),
          (h = new THREE.na(h, k)),
          h.position.set(0, 0, 0),
          (h.rid = a.Id),
          (h.catid = a.CatId),
          (h.lid = a.LevelId),
          (h.docid = a.DocId),
          (h.UniqueId = a.UniqueId),
          (h.srcna = c),
          (c.minina = h),
          (h.mycenter = g.center),
          (p = new THREE.LOD()),
          (p.UniqueId = a.UniqueId),
          (p.rid = a.Id),
          (p.catid = a.CatId),
          (p.lid = a.LevelId),
          (p.docid = a.DocId),
          c.position.set(-1 * g.center.x, -1 * g.center.y, -1 * g.center.z),
          p.position.set(g.center.x, g.center.y, g.center.z),
          p.addLevel(c, 1),
          p.addLevel(h, 100 * g.radius),
          this._009(a, p, null, a.UniqueId),
          this.sceneGroup.add(p))
        : (this._009(a, c, null, a.UniqueId), this.sceneGroup.add(c)),
      this._0x9C &&
        10 < c.myRadius &&
        ((g = new THREE.Edges_0x6(f, 89)),
        (g = new THREE.b2(g, new THREE.b3({ color: 8421504 }))),
        l && g.applyMatrix4(l),
        c.children.push(g)),
      !n)
    )
      return (n = { go: f, mt: k, UniqueId: a.UniqueId })
  },
  _0x1Av5: function (a, b) {
    var c = [],
      d = [],
      f = null,
      k = null,
      g = null,
      h = null,
      n = this,
      f = function (a) {
        for (var b = 0; b < n._0x3D.length; b++)
          if (n._0x3D[b].id == a) return n._0x3D[b]
        return null
      }
    a.isInstance && a.InstanceId && (g = f(a.InstanceId))
    if (g)
      (f = g.go),
        this._0x9C &&
          ((k = new THREE.Edges_0x6(f, 89)),
          (k = new THREE.b2(k, new THREE.b3({ color: 8421504 }))),
          (h = new THREE.Matrix4()),
          (h.elements = a.transform),
          h && k.applyMatrix4(h)),
        (c = g.mt)
    else {
      for (f = 0; f < a.Colors.length; f++) this._0xA01V3(c, d, a.Colors[f])
      var l = new THREE._0x2(),
        d = new THREE._0x3(new Float32Array(a.position), 3),
        f = new THREE._0x3(new Float32Array(a.normal), 3),
        p = new THREE._0x3(new Float32Array(a.color), 3),
        m = new THREE._0x3(new Float32Array(a.uv), 2)
      l.setAttribute('position', d)
      l.setAttribute('normal', f)
      l.setAttribute('color', p)
      l.setAttribute('uv', m)
      d.onUpload(function () {
        a.position = null
        a.normal = null
        a.color = null
        a.uv = null
        l.dispose()
      })
      for (d = 0; d < a.groups.length; d++)
        l.addGroup(
          a.groups[d].start,
          a.groups[d].count,
          a.groups[d].materialIndex
        )
      f = l
      this._0x9C &&
        ((k = new THREE.Edges_0x6(f, 89)),
        (k = new THREE.b2(k, new THREE.b3({ color: 8421504 }))),
        h && k.applyMatrix4(h))
      this.log_face_count += a.tngCount
    }
    d = new THREE.na(f, c)
    d.position.set(0, 0, 0)
    d.rid = a.Id
    d.catid = a.CatId
    d.lid = a.LevelId
    d.docid = a.DocId
    d.matrixAutoUpdate = null == g
    d.UniqueId = a.UniqueId
    h && d.applyMatrix4(h)
    g = new THREE.b7()
    g.setFromObject(d)
    g = new THREE._0x1().addVectors(g.max, g.min).multiplyScalar(0.5)
    isNaN(g.x) ||
      ((d.worldDir = new THREE._0x1().subVectors(g, this._0xA05).normalize()),
      (d.userData.oldPs = d.getWorldPosition(new THREE._0x1())),
      f.computeBoundingSphere(),
      (g = f.boundingSphere),
      (d.mycenter = g.center),
      50 < a.tngCount && 2 > g.radius
        ? ((h = new THREE.Sphere_0x6(g.radius / 2, 3, 3)),
          (c = new THREE.na(h, c)),
          c.position.set(0, 0, 0),
          (c.rid = a.Id),
          (c.catid = a.CatId),
          (c.lid = a.LevelId),
          (c.UniqueId = a.UniqueId),
          (c.srcna = d),
          (c.mycenter = g.center),
          (d.minina = c),
          (h = new THREE.LOD()),
          (h.rid = a.Id),
          (h.catid = a.CatId),
          (h.lid = a.LevelId),
          (h.docid = h.DocId),
          (h.UniqueId = a.UniqueId),
          d.position.set(-1 * g.center.x, -1 * g.center.y, -1 * g.center.z),
          h.position.set(g.center.x, g.center.y, g.center.z),
          h.addLevel(d, 1),
          h.addLevel(c, 100 * g.radius),
          this.sceneGroup.add(h))
        : this.sceneGroup.add(d),
      this._0x9C && d.children.push(k))
  },
  _0x1Av6: function (a, b, c, d, f, k) {
    var g = [],
      h = [],
      n = null,
      l = null,
      p = (l = null)
    a.Tf && 16 == a.Tf.length && ((p = new THREE.Matrix4()), (p.elements = a.Tf))
    k && (l = k)
    if (l) (n = l.go), (g = l.mt)
    else {
      for (n = 0; n < a.C.length; n++) this._0xA01V3(g, h, a.C[n])
      var n = new THREE._0x2(),
        m = new THREE._0x3(b, 3),
        q = new THREE._0x3(c, 3),
        r = new THREE._0x3(d, 3),
        u = new THREE._0x3(f, 2)
      n.setAttribute('position', m)
      n.setAttribute('normal', q)
      n.setAttribute('color', r)
      n.setAttribute('uv', u)
      m.onUpload(function () {
        u = r = q = m = f = d = c = b = null
      })
      for (h = 0; h < a.G.length; h++) n.addGroup(a.G[h].S, a.G[h].C, a.G[h].Mi)
      n.computeBoundingSphere()
    }
    this.log_face_count += n.attributes.position.count
    h = new THREE.na(n, g)
    h.position.set(0, 0, 0)
    h.rid = a.Id
    h.catid = a.Ci
    h.lid = a.Li
    h.docid = a.Di
    h.visible = -1 == this.defaultHideTypes.indexOf(a.Ci)
    h.matrixAutoUpdate = null == l
    h.UniqueId = a.Ui
    p && h.applyMatrix4(p)
    l = new THREE.b7()
    l.setFromObject(h)
    l = new THREE._0x1().addVectors(l.max, l.min).multiplyScalar(0.5)
    if (!isNaN(l.x)) {
      h.worldDir = new THREE._0x1().subVectors(l, this._0xA05).normalize()
      h.userData.oldPs = h.getWorldPosition(new THREE._0x1())
      l = n.boundingSphere
      h.mycenter = new THREE._0x1(l.center.x, l.center.y, l.center.z)
      p && h.mycenter.applyMatrix4(p)
      h.myRadius = l.radius
      k = 9
      g[0] &&
        g[0].transparent &&
        ((k = Math.floor(10 - 10 * g[0].opacity)), (k = 0 > k ? 0 : k))
      h.renderOrder = k
      this._012 || this.octree.add(h)
      if (50 < a.Tc && 2 > l.radius) {
        k = g[0].color
        var v = new THREE.Sphere_0x6(l.radius / 2, 3, 3)
        k = new THREE.na(v, new THREE.q7({ color: k }))
        k.position.set(0, 0, 0)
        k.rid = a.Id
        k.catid = a.Ci
        k.lid = a.Li
        k.UniqueId = a.Ui
        k.srcna = h
        k.mycenter = l.center
        h.minina = k
        v = new THREE.LOD()
        v.rid = a.Id
        v.catid = a.Ci
        v.lid = a.Li
        v.docid = v.Di
        v.UniqueId = a.Ui
        v.myRadius = h.myRadius
        v.mycenter = h.mycenter
        h.position.set(-1 * l.center.x, -1 * l.center.y, -1 * l.center.z)
        v.position.set(l.center.x, l.center.y, l.center.z)
        v.addLevel(h, 1)
        v.addLevel(k, 100 * l.radius)
        this._009(a, v, null, a.Ui)
        this.sceneGroup.add(v)
      } else this.sceneGroup.add(h), this._009(a, h, null, a.Ui)
      this._0x9C &&
        0.1 < h.myRadius / n.attributes.position.count &&
        0 < g.length &&
        null == g[0].map &&
        ((l = new THREE.Edges_0x6(n, 89)),
        (l = new THREE.b2(l, new THREE.b3({ color: 8421504 }))),
        p && l.applyMatrix4(p),
        (l.renderOrder = 9),
        h.children.push(l))
      return { id: a.Ui, go: n, mt: g }
    }
  },
  _0x1Av7: function (a, b, c, d, f, k) {
    for (var g = [], h = [], n = new THREE.Matrix4(), l = 0; l < a.C.length; l++)
      this._0xA01V3(g, h, a.C[l])
    h = new THREE._0x2()
    l = new THREE._0x3(b, 3)
    c = new THREE._0x3(c, 3)
    d = new THREE._0x3(d, 3)
    f = new THREE._0x3(f, 2)
    h.setAttribute('position', l)
    h.setAttribute('normal', c)
    h.setAttribute('color', d)
    h.setAttribute('uv', f)
    for (f = 0; f < a.G.length; f++) h.addGroup(a.G[f].S, a.G[f].C, a.G[f].Mi)
    h.computeBoundingSphere()
    this.log_face_count += h.attributes.position.count
    16 == a.Tf.length && (n.elements = a.Tf)
    l = 0
    f = new THREE.Instancedna(h, g, k.length + 1)
    for (c = 0; c < k.length; c++)
      (d = new THREE.Matrix4()),
        (d.elements = k[c].Tf),
        this._009(k[c], f, l, a.Ui),
        f.setMatrixAt(l++, d)
    this._009(a, f, l, a.Ui)
    f.UniqueId = a.Ui
    f.setMatrixAt(l, n)
    if (null == k || 0 == k.length) f.frustumCulled = !0
    k.push(a)
    f.meshList = k
    a = h.boundingSphere
    f.mycenter = new THREE._0x1(a.center.x, a.center.y, a.center.z)
    f.myRadius = a.radius
    a = 9
    g[0] &&
      g[0].transparent &&
      ((a = Math.floor(10 - 10 * g[0].opacity)), (a = 0 > a ? 0 : a))
    f.renderOrder = a
    this.sceneGroup.add(f)
  },
  createMergena: function (a, b) {
    if (0 != a.length) {
      this.myOne = THREE._0x2Utils.mergeBufferGeometries(a, b)
      var c = new THREE.na(this.myOne, this._0x1D)
      this.myOne = null
      c.position.set(0, 0, 0)
      this.sceneGroup.add(c)
    }
  },
  addIntoMaterialGroup: function (a, b, c) {
    a = this.mtrMap.get(a)
    null == a
      ? (this.mgrGlobal_0x6s.objs.push(c),
        this.mgrGlobal_0x6s.geometries.push(b))
      : (a.mgr_0x6s.push(b), a.mgrObjs.push(c))
  },
  _0x1AMerge: function (a, b, c, d, f, k) {
    var g = [],
      h = [],
      n = null,
      l = null,
      p = null
    a.Tf && 16 == a.Tf.length && ((p = new THREE.Matrix4()), (p.elements = a.Tf))
    b && (l = b)
    if (l) (n = l.go.clone()), (g = l.mt), (a.C = l.C)
    else {
      for (n = 0; n < a.C.length; n++) this._0xA01V3(g, h, a.C[n])
      var n = new THREE._0x2(),
        m = new THREE._0x3(c, 3),
        q = new THREE._0x3(d, 3),
        r = new THREE._0x3(f, 3),
        u = new THREE._0x3(k, 2)
      n.setAttribute('position', m)
      n.setAttribute('normal', q)
      n.setAttribute('color', r)
      n.setAttribute('uv', u)
      m.onUpload(function () {
        u = r = q = m = k = f = d = c = null
      })
      for (h = 0; h < a.G.length; h++) n.addGroup(a.G[h].S, a.G[h].C, a.G[h].Mi)
      n.computeBoundingSphere()
    }
    this.log_face_count += n.attributes.position.count
    if (1 == g.length) {
      if (a.C.length !== g.length) debugger
      p && n.applyMatrix4(p)
      this.addIntoMaterialGroup(g[0].uuid, n, a)
    } else
      (p = new THREE.na(n, g)),
        (p.rid = a.Id),
        (p.catid = a.Ci),
        (p.lid = a.Li),
        (p.docid = a.Di),
        this.sceneGroup.add(p)
    if (null == b) return { id: a.Ui, go: n, mt: g, C: a.C }
  },
  create_0x0F: function () {
    var a = [],
      b = []
    a.push(new THREE._0x1(0, 0, 0))
    a.push(new THREE._0x1(-1, 1, 2))
    a.push(new THREE._0x1(1, 1, 2))
    a.push(new THREE._0x1(0, -1, 2))
    var c = new THREE._0x4(0, 1, 2)
    c.color.setHex(16711680)
    c.materialIndex = 0
    b.push(c)
    c = new THREE._0x4(0, 2, 3)
    c.color.setHex(16711680)
    c.materialIndex = 0
    b.push(c)
    c = new THREE._0x4(0, 3, 1)
    c.color.setHex(16711680)
    c.materialIndex = 0
    b.push(c)
    c = new THREE._0x4(1, 2, 3)
    c.color.setHex(16711680)
    c.materialIndex = 0
    b.push(c)
    c = new THREE._0x6()
    c.vertices = a
    c.faces = b
    c.computeFaceNormals()
    this._0x0F = c
  },
  addnas: function (a, b) {
    var c = [],
      d = [],
      f = [],
      k = this._0x9E[b % this._0x9E.length],
      g = new THREE.q7({
        color: k,
        vertexColors: THREE.fc,
        transparent: !0,
        side: THREE.ds,
        wireframe: !1,
      })
    f.push(g)
    for (g = 0; g < a.Points.length; g++) {
      var h = a.Points[g]
      c.push(new THREE._0x1(h.X, h.Y, h.Z))
    }
    for (g = 0; g < a.Faces.length; g++)
      (h = a.Faces[g].split(',')),
        (h = new THREE._0x4(h[0], h[1], h[2])),
        h.color.setHex(k),
        (h.materialIndex = 0),
        d.push(h)
    this.log_face_count += a.Faces.length
    k = new THREE._0x6()
    k.vertices = c
    k.faces = d
    k.computeFaceNormals()
    c = new THREE.na(k, f)
    c.position.set(0, 0, 0)
    c.rid = a.naName
    c.catid = a.naName
    c.lid = a.naName
    c.docid = a.naName
    c.UniqueId = a.naName
    this._0x9C &&
      ((d = new THREE.Edges_0x6(k, 89)),
      (d = new THREE.b2(d, new THREE.b3({ color: 8421504 }))),
      c.children.push(d))
    this.sceneGroup.add(c)
  },
  _0x1AIns: function (a) {
    for (
      var b = [], c = [], d = [], f = [], k = 0 < a.UVs.length, g = 0;
      g < a.Colors.length;
      g++
    )
      this._0xA01V3(d, f, a.Colors[g])
    for (g = 0; g < a.Pt.length; g += 3)
      b.push(new THREE._0x1(a.Pt[g], a.Pt[g + 1], a.Pt[g + 2]))
    if (k)
      for (g = 0; g < a.UVs.length; g++)
        c.push(new THREE.vt2(0.127 * a.UVs[g], 0.127 * a.UVs[g + 1]))
    var h = 1,
      n = []
    normalss = []
    colorss = []
    uvmi = []
    groups = []
    var l = 0
    a.Faces[0] && a.Faces[0].MtrId && (l = a.Faces[0].MtrId)
    for (var p = 0, m = 0, g = 0; g < a.Faces.length; g++) {
      var q = null
      a.Faces[g].Nor && (q = a.Faces[g].Nor.split(','))
      var r = this.setHexmi(parseInt(f[a.Faces[g].MtrId][0]))
      l != a.Faces[g].MtrId &&
        (groups.push({ start: m, count: p, materialIndex: l }),
        (l = a.Faces[g].MtrId),
        (m += p),
        (p = 0))
      g == a.Faces.length - 1 &&
        ((p += a.Faces[g].Tgs.length),
        groups.push({ start: m, count: p, materialIndex: l }))
      for (
        var p = p + a.Faces[g].Tgs.length, u = 0;
        u < a.Faces[g].Tgs.length;
        u += 3
      ) {
        h++
        var v = [
            a.Faces[g].Tgs[u],
            a.Faces[g].Tgs[u + 1],
            a.Faces[g].Tgs[u + 2],
          ],
          z = 0 < a.Faces[g].Uvset.length && a.Faces[g].Uvset[u]
        if (z)
          var y = [
            a.Faces[g].Uvset[u],
            a.Faces[g].Uvset[u + 1],
            a.Faces[g].Uvset[u + 2],
          ]
        q || (q = this._0x2A(b[v[0]], b[v[1]], b[v[2]]))
        for (var w = 0; 3 > w; w++) {
          for (var x = 0; 3 > x; x++)
            n.push(b[v[w]][x]), normalss.push(q[x]), colorss.push(r[x])
          if (k && z) for (x = 0; 2 > x; x++) uvmi.push(c[y[w]][x])
          else uvmi.push(0), uvmi.push(0)
        }
      }
    }
    b = new THREE._0x2()
    b.setAttribute('position', new THREE._0x3(new Float32Array(n), 3))
    b.setAttribute('normal', new THREE._0x3(new Float32Array(normalss), 3))
    b.setAttribute('color', new THREE._0x3(new Float32Array(colorss), 3))
    b.setAttribute('uv', new THREE._0x3(new Float32Array(uvmi), 2))
    for (n = 0; n < groups.length; n++)
      b.addGroup(groups[n].start, groups[n].count, groups[n].materialIndex)
    this.log_face_count += h
    this._0x3D.push({ id: a.UniqueId, go: b, mt: d })
  },
  _0x1AIns2: function (a, b, c, d, f) {
    for (var k = [], g = [], h = 0; h < a.C.length; h++)
      this._0xA01V3(k, g, a.C[h])
    var n = new THREE._0x2(),
      l = new THREE._0x3(b, 3),
      p = new THREE._0x3(c, 3),
      m = new THREE._0x3(d, 3),
      q = new THREE._0x3(f, 2)
    n.setAttribute('position', l)
    n.setAttribute('normal', p)
    n.setAttribute('color', m)
    n.setAttribute('uv', q)
    l.onUpload(function () {
      q = m = p = l = f = d = c = b = null
      n.dispose()
      n = null
    })
    for (g = 0; g < a.G.length; g++) n.addGroup(a.G[g].S, a.G[g].C, a.G[g].Mi)
    n.computeBoundingSphere()
    this.log_face_count += a.Tc
    a = { id: a.Ui, go: n, mt: k }
    this._0x3D.push(a)
    this._0x3Dqm.set(a.id, a)
  },
  _0x3A: function (a) {
    this._0x0C = new THREE.AxisHelper(a)
    this._0x0B.add(this._0x0C)
  },
  _0x4A: function (a) {
    !this._0x6C && this._0x0C && this._0x0C.position.set(a.x, a.y, a.z)
  },
  resize: function () {
    this._0x1C = document.getElementById('container').getBoundingClientRect()
    this.size.w = window.innerWidth
    this.size.h = window.innerHeight
    this._0x9B.aspect = this.size.w / this.size.h
    this._0x9B.updateProjectionMatrix()
    this._0x2C.setSize(this.size.w, this.size.h)
  },
  updateLOD: function () {
    var a = this
    a._012 ||
      a.isSurvey ||
      a.mgr ||
      (a.octree.update(),
      a.sceneGroup.children.forEach(function (b) {
        if (
          ('na' === b.type || 'LOD' === b.type) &&
          a._0x9C &&
          0 < b.children.length &&
          'b2' === b.children[0].type
        ) {
          var c = new THREE._0x1(),
            d = new THREE._0x1()
          c.setFromMatrixPosition(a._0x9B.matrixWorld)
          d.copy(b.mycenter)
          c = c.distanceTo(d)
          b.children[0].visible = 200 > c
        }
      }))
  },
  Myrander: function () {
    if (!this.stopRander) {
      this._0x6C && this._0x6E.update(0.005)
      var a = this
      a.crm = new Date().valueOf()
      this._0x2C &&
        ((a._0x0B.crm = a.crm),
        (this._0x0B.funcrm = function (b) {
          return a.crm !== b
        }),
        this._0x2C.clear(!0, !0, !0),
        this._0x2C.render(this._0x0B, this._0x9B),
        b4.update(),
        this._0x1E && this.circleRol())
    }
  },
  circleRol: function () {
    this.theta += 0.1
    this._0x9B.position.x =
      10 * this._0xA05.x * Math.sin(THREE.Math.degToRad(this.theta))
    this._0x9B.position.y =
      10 * this._0xA05.y * Math.cos(THREE.Math.degToRad(this.theta))
    this._0x9B.lookAt(this._0xA05)
    this._0x9B.updateMatrixWorld()
    this.onChangeCallBack()
  },
  _0x6A: function (a) {
    var b = null
    if (this._0x4C.Enable) {
      if (0 == this._0x4C.ClipIndex)
        for (var c = 0; c < a.length; c++)
          if (a[c].point.x > this._0x4C.Value) {
            b = a[c]
            break
          }
      if (1 == this._0x4C.ClipIndex)
        for (c = 0; c < a.length; c++)
          if (a[c].point.y > this._0x4C.Value) {
            b = a[c]
            break
          }
      if (2 == this._0x4C.ClipIndex)
        for (c = 0; c < a.length; c++)
          if (a[c].point.z > this._0x4C.Value) {
            b = a[c]
            break
          }
      if (3 == this._0x4C.ClipIndex)
        for (c = 0; c < a.length; c++)
          if (a[c].point.x < this._0x4C.Value) {
            b = a[c]
            break
          }
      if (4 == this._0x4C.ClipIndex)
        for (c = 0; c < a.length; c++)
          if (a[c].point.y < this._0x4C.Value) {
            b = a[c]
            break
          }
      if (5 == this._0x4C.ClipIndex)
        for (c = 0; c < a.length; c++)
          if (a[c].point.z < this._0x4C.Value) {
            b = a[c]
            break
          }
    } else b = a[0]
    return b
  },
  sphere: function (a, b, c, d, f, k) {
    k = new THREE.Sphere_0x6(k, 10, 10)
    d = new THREE.q7({
      color: d,
      wireframe: !1,
      transparent: !0,
      side: THREE.ds,
      opacity: f,
    })
    d = new THREE.na(k, d)
    d.position.set(a, b, c)
    return d
  },
  _0x7A: function (a) {
    if (0 == this._0x5A.length) return 0
    'LOD' === this._0x5A[0].parent.type
      ? this._0x00(
          this._0x9B.position,
          this._0x9B.position,
          this._0x6E.target,
          this._0x5A[0].parent.position
        )
      : (a ||
          ((a = this._0x5A[0].geometry),
          a.computeBoundingBox(),
          (a = a.boundingBox),
          (a = {
            x: 0.5 * (a.max.x + a.min.x) + this._0x5A[0].position.x,
            y: 0.5 * (a.max.y + a.min.y) + this._0x5A[0].position.y,
            z: 0.5 * (a.max.z + a.min.z) + this._0x5A[0].position.z,
          })),
        this._0x00(
          this._0x9B.position,
          this._0x9B.position,
          this._0x6E.target,
          a
        ))
    return 1
  },
  _008: function (a) {
    return this._012 ? this._008v2(a) : this._008v1(a)
  },
  _008v1: function (a) {
    var b = this.getnaById(a)
    if (!b) return 0
    0 < this._0x5A.length &&
      (this._0xA03(this._0x5A[0], null), (this._0x5A = []))
    this._0x5A.push(b)
    this._0xA03(b, new THREE.Color(12582924), 1)
    var c = null,
      c =
        'LOD' === this._0x5A[0].parent.type
          ? this._0x5A[0].parent.position
          : this._0x5A[0].mycenter,
      b = { x: c.x - 10, y: c.y - 10, z: c.z + 10 }
    this._0x5A[0].renderOrder = 9
    this._0x00(this._0x9B.position, b, this._0x6E.target, c)
    this._0xF7()
    this._0xE10(a, [c.x, c.y, c.z])
    var d = this
    setTimeout(function () {
      0 < d.transcmps.length && (d._0xC5(d.transcmps, 1), (d.transcmps = []))
      var b = new THREE._0x1(c.x, c.y, c.z),
        b = b.unproject(d._0x9B),
        b = new THREE.rct(
          d._0x9B.position,
          b.sub(d._0x9B.position).normalize()
        ).intersectObjects(d.sceneGroup.children)
      d.transcmps = []
      for (var k in b)
        if (b.hasOwnProperty(k)) {
          var g = b[k].object
          console.log(g.UniqueId)
          g.UniqueId !== a && d.transcmps.push(g.UniqueId)
        }
      d._0xC5(d.transcmps, 0.1)
      d.Myrander()
    }, 1e3)
    return 1
  },
  _008v2: function (a) {
    var b = this.getnaByIdv2(a)
    if (!b) return 0
    var c = b.mesh.mycenter,
      d = b.mesh.getMatrixAt_qmodel(b.insId)
    c.applyMatrix4(d)
    this._0x00(
      this._0x9B.position,
      { x: c.x - 10, y: c.y - 10, z: c.z + 10 },
      this._0x6E.target,
      c
    )
    this._0xF7()
    this._0xE10(a, [c.x, c.y, c.z])
    this.setSelect([b])
    return 1
  },
  _0x8A: function (a) {
    this._0x6E.target.set(a[0], a[1], a[2])
    this._0x6E.update()
    return 1
  },
  _0x9A: function (a, b) {
    this._0x6E && this._0x6E.dispose()
    this._0x6C
      ? ((this._0x6E = new THREE.FirstPersonControls(this._0x9B, b)),
        (this._0x6E.enabled = !0),
        (this._0x6E.lookSpeed = 0.1),
        (this._0x6E.movementSpeed = 20),
        (this._0x6E.noFly = !1),
        (this._0x6E.constrainVertical = !0),
        (this._0x6E.verticalMin = 1),
        (this._0x6E.verticalMax = 2),
        (this._0x6E.lon = 0),
        (this._0x6E.lat = 0),
        this._0x6E.setCallBack(this.onChangeCallBack))
      : ((this._0x6E = new THREE._0x8(this._0x9B, b)),
        this._0x6E.setCallBack(this.onChangeCallBack),
        this._0x6E.target.set(0, 0, 0),
        this._0x6E.update(),
        1 === a && this._0xD2())
    return this._0x6E
  },
  setWalk: function () {
    ;(this._0x6C = !this._0x6C)
      ? (this._0x0C && this._0x0B.remove(this._0x0C), this._0xF7())
      : this._0x0C && this._0x0B.add(this._0x0C)
    return 1
  },
  mouseWheel: function (a) {},
  _0xA03: function (a, b, c) {
    if (!this.mgr)
      if (
        ((c = c ? c : 0.7),
        b
          ? ((a.backMtr = []),
            (this._0x2D.color = b),
            a.userMtr && (a.userMtr.opacity = c))
          : a.userMtr && (a.userMtr.opacity = 1),
        (this._0x2D.opacity = c),
        (this._0x2D.transparent = 1 > c),
        b || a.userMtr)
      )
        for (
          a.backMtr = a.material, a.material = [], b = 0;
          b < a.backMtr.length;
          b++
        )
          a.material.push(a.userMtr ? a.userMtr : this._0x2D)
      else a.material = a.backMtr
  },
  setSelect: function (a) {
    for (var b, c = 0; c < this._0x5D.length; c++)
      (b = this._0x5D[c]),
        null != b.insId ? b.mesh._011(b.insId) : this._0xA03(b.mesh, null)
    for (c = 0; c < a.length; c++)
      (b = a[c]),
        null != b.insId
          ? b.mesh._010(b.insId, this._0x2D, this._0x0B)
          : this._0xA03(b.mesh, new THREE.Color(12582924))
    this._0x5D = a
  },
  mouseDown: function (a) {
    this._0x7D &&
      (this.setSelect([]),
      this._0xB4.startPoint.set(
        (a.clientX / this.size.w) * 2 - 1,
        2 * -(a.clientY / this.size.h) + 1,
        0.5
      ))
  },
  mouseOver: function (a, b) {
    if (this._0x6E.showRay) {
      var c = new THREE._0x1(
          (a.clientX / this.size.w) * 2 - 1,
          2 * -(a.clientY / this.size.h) + 1,
          0.5
        ),
        c = c.unproject(this._0x9B),
        d = new THREE.rct(
          this._0x9B.position,
          c.sub(this._0x9B.position).normalize()
        ).intersectObjects(this.components)
      0 < d.length &&
        ((c = []),
        c.push(new THREE._0x1(-30, 39.8, 30)),
        c.push(d[0].point),
        (d = new THREE.naBasicMaterial({
          color: 16711680,
          transparent: !0,
          opacity: 0.6,
        })),
        (c = new THREE.Tube_0x6(new THREE.SplineCurve3(c), 60, 0.001)),
        this.tube && this._0x0B.remove(tube),
        this._0x6E.showRay &&
          ((this.tube = new THREE.na(c, d)), this._0x0B.add(tube)))
    }
    !b || (2 != b.down && 0 != b.down && 1 != b.down) || this._0xF8()
  },
  mouseUp: function (a, b) {
    0 < this.transcmps.length &&
      (this._0xC5(this.transcmps, 1), (this.transcmps = []))
    if (this._0x7D && b) {
      this._0xB4.endPoint.set(
        (a.clientX / this.size.w) * 2 - 1,
        2 * -(a.clientY / this.size.h) + 1,
        0.5
      )
      var c = this._0xB4.select()
      this.setSelect(c)
      this.onChangeCallBack()
    } else if (
      !b &&
      ((c = new THREE.vt2()),
      (c.x = (a.clientX / this.size.w) * 2 - 1),
      (c.y = 2 * -(a.clientY / this.size.h) + 1),
      this._0x0D.setFromCamera(c, this._0x9B),
      this._012
        ? (c = this._0x0D.intersectObjects(this.sceneGroup.children, !1))
        : ((c = this.octree.searchna(
            this._0x0D.ray.origin,
            this._0x0D.ray.far,
            !0,
            this._0x0D.ray.direction
          )),
          (c = this._0x0D.intersectObjects(c, !1))),
      0 < this._0x5A.length && (this.setSelect([]), (this._0x5A = [])),
      0 < c.length &&
        ((c = this._0x4C.Enable ? this._0x6A(c) : c[0]), null != c))
    )
      if ((console.log(c), this._0x8D))
        if (null == this._0x9D)
          (this._0x9D = c.point),
            this._0x0E.add(
              this.sphere(c.point.x, c.point.y, c.point.z, 16711680, 1, 0.2)
            )
        else {
          this._0x0E.add(
            this.sphere(c.point.x, c.point.y, c.point.z, 65280, 1, 0.2)
          )
          var d = new THREE.b3({ color: 255 }),
            f = new THREE._0x6()
          f.vertices.push(this._0x9D)
          f.vertices.push(c.point)
          d = new THREE.Line(f, d)
          this._0x0E.add(d)
          d = c.point.distanceTo(this._0x9D)
          console.log('\u8ddd\u79bb\x3d' + d)
          this._0x9D = null
          this._0xF4Mr(c.point, 0.001 * Math.round(304.8 * d))
          this.onChangeCallBack()
        }
      else {
        d = c.object.UniqueId
        f = c.object.docid
        if (null != c.instanceId) {
          this.setSelect([{ mesh: c.object, insId: c.instanceId }])
          var k = this.qmlist.get(d + '^' + c.instanceId.toString())
          k && ((d = k.obj.Ui), (f = k.obj.Di))
        } else this.setSelect([{ mesh: c.object, insId: null }])
        this._0xA02n(f, d)
        d = f + '^' + d
        this._0x5C &&
          (this._0xE10(d, [c.point.x, c.point.y, c.point.z]),
          this._0x5CCl && this._0x5CCl())
        d &&
          (console.log(window.location.href + '\x26lookat\x3d' + d),
          (f = document.getElementById('qrcode1')),
          (k = $(f)),
          (f.innerHTML = ''),
          createQrCode(
            k,
            window.location.href + '\x26lookat\x3d' + d,
            150,
            150
          ))
        this._0x5A.push(c.object)
        this._0xB8 && this._0xB8(d)
        this._0x6C || this._0x7A(c.point)
      }
  },
  _0xA02n: function (a, b) {
    var c = this,
      d = document.getElementById('tableProperty')
    this._0xB3 = []
    d.innerHTML = ''
    b &&
      this.net._0x3B1(a, b).then(function (a) {
        JSON.parse(a).forEach(function (a) {
          var b = new TreeTableNode(d)
          c._0xB3.push(b)
          b.addtbTale(a)
        })
      })
  },
  _0xA02: function (a) {
    var b = this,
      c = document.getElementById('tableProperty')
    this._0xB3 = []
    c.innerHTML = ''
    if (this.isSurvey)
      'BH' == a.docid &&
        this._0x3C.Mps.forEach(function (d) {
          if (a.UniqueId == d.BH) {
            var f = {
              text:
                a.UniqueId +
                ',\u5b54\u53e3\u9ad8\u7a0b:' +
                d.Z.toString() +
                'm',
              children: [],
            }
            f.children.push(
              '\u4e3b\u5c42-\u4e9a\u5c42,\u5c42\u5e95\u6df1\u5ea6(m)'
            )
            d.Dps.forEach(function (a) {
              f.children.push(a.ZName + ',' + a.D.toString())
            })
            d = new TreeTableNode(c)
            b._0xB3.push(d)
            d.addtbTale(f)
          }
        })
    else if (4 == this.mversion)
      a.UniqueId &&
        this.net._0x3B1(a.docid, a.UniqueId).then(function (a) {
          JSON.parse(a).forEach(function (a) {
            var d = new TreeTableNode(c)
            b._0xB3.push(d)
            d.addtbTale(a)
          })
        })
    else {
      var d = a.rid
      this._0x3C.Cmps.forEach(function (a) {
        a.Id === d &&
          a.Prmgs.forEach(function (a) {
            var d = new TreeTableNode(c)
            b._0xB3.push(d)
            d.addtbTale(a)
          })
      })
    }
  },
  _00A: function () {
    var a = this
    this.viewList = []
    var b = document.getElementById('tableView')
    b.innerHTML = ''
    var c = createDOM('tr', 'qm-group-content')
    c.innerHTML =
      ' \x3ctd class\x3d"qm-key"\x3e\u89c6\u56fe\u540d\u79f0\x3c/td\x3e\x3ctd class\x3d"qm-value"\x3e\u4e8c\u7ef4\u7801\x3c/td\x3e\x3ctd style\x3d"width:120px;"\x3e\u64cd\u4f5c\x3c/td\x3e'
    b.appendChild(c)
    this.net.getView().then(function (c) {
      c.forEach(function (c) {
        a.viewList.push(c)
        b.appendChild(a._00D(c))
      })
    })
  },
  _00B: function () {
    var a = this
    a.viewList.forEach(function (b) {
      a._0xF3(b.markInfo, b.viewName)
    })
  },
  _00C: function () {
    var a = this,
      b = document.getElementById('tablePlan')
    b.innerHTML = ''
    var c = createDOM('tr', 'qm-group-content')
    c.innerHTML =
      ' \x3ctd class\x3d"qm-key"\x3e\u8ba1\u5212\u540d\u79f0\x3c/td\x3e\x3ctd class\x3d"qm-value"\x3e\u5b8c\u6210\u65e5\u671f\x3c/td\x3e\x3ctd style\x3d"width:120px;"\x3e\u64cd\u4f5c\x3c/td\x3e'
    b.appendChild(c)
    this.net.getSche().then(function (c) {
      c.forEach(function (c) {
        b.appendChild(a._00E(c))
      })
    })
  },
  _007: function (a) {
    var b = this
    b.net.getViewById(a).then(function (a) {
      b._0xF7()
      b._0xE8(a.viewInfo2)
      b._0xF3(a.markInfo, a.viewName)
    })
  },
  _00D: function (a) {
    var b = createDOM('tr', 'qm-group-content'),
      c = createDOM('td', '')
    c.style.width = '80%'
    c.innerHTML =
      '\x3ca onclick\x3d_005G(' + a.id + ')\x3e' + a.viewName + '\x3c/a\x3e'
    b.appendChild(c)
    c = createDOM('td', '')
    c.style.width = '100px'
    var d = createDOM('div', ''),
      f = $(d)
    createQrCode(f, window.location.href + '\x26mark\x3d' + a.id, 100, 100)
    c.appendChild(d)
    b.appendChild(c)
    c = createDOM('td', '')
    c.style.width = '100px'
    c.innerHTML =
      '\x3cdiv class\x3d"qm-button-mini qmd-see" onclick\x3d_005G(' +
      a.id +
      ') title\x3d"\u67e5\u770b"\x3e\x3c/div\x3e\x3cdiv class\x3d"qm-button-mini qmd-delete" onclick\x3d_001G(' +
      a.id +
      ') title\x3d"\u5220\u9664"\x3e\x3c/div\x3e'
    b.appendChild(c)
    return b
  },
  _00E: function (a) {
    var b = createDOM('tr', 'qm-group-content')
    b.innerHTML =
      ' \x3ctd class\x3d"qm-key"\x3e' +
      a.taskName +
      '\x3c/td\x3e\x3ctd class\x3d"qm-value"\x3e' +
      a.finishDate +
      '\x3c/td\x3e\x3ctd\x3e\x3cdiv class\x3d"qm-button-mini qmd-see" onclick\x3d_004G(' +
      a.id +
      ') title\x3d"\u67e5\u770b"\x3e\x3c/div\x3e\x3cdiv class\x3d"qm-button-mini qmd-delete" onclick\x3d_00FG(' +
      a.id +
      ') title\x3d"\u5220\u9664"\x3e\x3c/div\x3e\x3cdiv class\x3d"qm-button-mini qmd-bangding" onclick\x3d_006G(' +
      a.id +
      ') title\x3d"\u7ed1\u5b9a"\x3e\x3c/div\x3e\x3c/td\x3e'
    return b
  },
  _00F: function (a) {
    var b = this
    this.net.DelSche(a).then(function (a) {
      1 === a && (b._00C(), alert('\u5220\u9664\u6210\u529f'))
    })
  },
  _001: function (a) {
    var b = this
    this.net.DelView(a).then(function (a) {
      1 === a && (b._00A(), alert('\u5220\u9664\u6210\u529f'))
    })
  },
  _002: function () {
    var a = this,
      b = document.getElementById('tablePlan')
    b.innerHTML = ''
    var c = createDOM('tr', 'qm-group-content')
    c.innerHTML =
      ' \x3ctd class\x3d"qm-key"\x3e\u8ba1\u5212\u540d\u79f0\x3c/td\x3e\x3ctd class\x3d"qm-value"\x3e\u5b8c\u6210\u65e5\u671f\x3c/td\x3e\x3ctd style\x3d"width:120px;"\x3e\u64cd\u4f5c\x3c/td\x3e'
    b.appendChild(c)
    a._0xD10(!1)
    this.net.getSche().then(function (c) {
      var d = 0,
        k = self.setInterval(function () {
          var f = c[d]
          b.appendChild(a._00E(f))
          a._003(f.id)
          d++
          d >= c.length && (a._0xD10(!0), clearInterval(k))
        }, 3e3)
    })
  },
  _003: function (a) {
    var b = this
    this.net.getBangdingSche(a).then(function (a) {
      if (0 < a.length) {
        var c = new Map(),
          f
        for (f in a)
          if (a.hasOwnProperty(f)) {
            var k = a[f]
            c.set(k.compId, k.compId)
          }
        b._0xC7map(c, !0)
        c.clear()
      }
    })
  },
  _004: function (a) {
    var b = this
    this.net.getBangdingSche(a).then(function (a) {
      if (0 < a.length) {
        var c = new Map(),
          f
        for (f in a)
          if (a.hasOwnProperty(f)) {
            var k = a[f]
            c.set(k.compId, k.compId)
          }
        b._0xD10(!1)
        b._0xC7map(c, !0)
        c.clear()
      }
    })
  },
  _005: function (a) {
    var b = this
    b.viewList.forEach(function (c) {
      c.id === a &&
        (b._0xF7(), b._0xE8(c.viewInfo2), b._0xF3(c.markInfo, c.viewName))
    })
  },
  _006: function (a) {
    var b = this._0xC4()
    0 === b.length
      ? alert('\u8bf7\u9009\u6846\u9009\u6784\u4ef6\u3002')
      : this.net.BangdingSche(a, b).then(function (a) {
          1 === a && alert('\u7ed1\u5b9a\u6210\u529f')
        })
  },
  _0x2B: function (a, b, c) {
    a = new THREE._0x1(a, b, c)
    b = 0.5 * this.size.w
    c = 0.5 * this.size.h
    a.project(this._0x9B)
    a.x = a.x * b + b
    a.y = -(a.y * c) + c
    return { x: a.x, y: a.y }
  },
  _0x1B: function (a) {
    var b = new THREE._0x1(),
      c = 0.5 * this.size.w,
      d = 0.5 * this.size.h
    a.updateMatrixWorld()
    b.setFromMatrixPosition(a.matrixWorld)
    b.y *= 2
    b.project(this._0x9B)
    b.x = b.x * c + c
    b.y = -(b.y * d) + d
    return { x: b.x, y: b.y }
  },
  _0xBD: function (a) {
    var b = this
    b.tmpOn = a
    setTimeout(function () {
      b.tmpOn != a
        ? console.log('givup')
        : (b.sceneGroup.children.forEach(function (c) {
            c.isna &&
              c.worldDir &&
              (0 < a && b._0x9C && (c.children.length = 0),
              c.position.copy(
                new THREE._0x1()
                  .copy(c.userData.oldPs)
                  .add(new THREE._0x1().copy(c.worldDir).multiplyScalar(a))
              ))
          }),
          0 < a && (b._0x9C = !1))
    }, 100)
  },
  _0x00: function (a, b, c, d) {
    var f = this
    a = new b4.Tween({ x1: a.x, y1: a.y, z1: a.z, x2: c.x, y2: c.y, z2: c.z })
    a.to({ x1: b.x, y1: b.y, z1: b.z, x2: d.x, y2: d.y, z2: d.z }, 1e3)
    a.onUpdate(function () {
      f._0x9B.position.x = this.x1
      f._0x9B.position.y = this.y1
      f._0x9B.position.z = this.z1
      f._0x6E.target.x = this.x2
      f._0x6E.target.y = this.y2
      f._0x6E.target.z = this.z2
      f._0x6E.update()
      f._0xF8()
    })
    a.onComplete(function () {
      f._0x6E.enabled = !0
      f._0xF8()
    })
    a.easing(b4.Easing.Cubic.InOut)
    a.start()
    this.onChangeCallBack()
  },
}
function _0x9F(a) {
  return a.document.getElementById('pageWidgetContainer' + (0).toString())
}
function guid() {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (a) {
    var b = (16 * Math.random()) | 0
    return ('x' == a ? b : (b & 3) | 8).toString(16)
  })
}
function _0x8F() {
  try {
    return this.viewerElement.querySelector('iframe').contentWindow
  } catch (a) {
    return null
  }
}
function _0x5F() {
  this._0x8F()
  this._nowDrawType = ''
  this._isStartDraw = !1
  this._isStopDraw = !0
  this._nowDrawSvgRectId = this._0x6FMarkId = ''
}
function _0x7F(a) {
  return a.document.querySelector(
    'svg[data-pdf-annotate-page\x3d"' + document._nowPageNum.toString() + '"]'
  )
}
function _0x6F(a) {
  var b = document
  a.target.classList.contains('qm-checked')
    ? a.target.classList.remove('qm-checked')
    : (a.target.classList.add('qm-checked'),
      b._nowChecked && b._nowChecked.classList.remove('qm-checked'),
      (b._nowChecked = a.target))
  _0x5F()
  b._nowDrawType = '_0x6F'
  b._isStopDraw = !1
  _0x4F()
  a = _0x8F()
  var c = _0x7F(a)
  c.onmousedown = function (a) {
    if (!b.ctrlKeyCode)
      if ('SVG' === a.target.tagName.toUpperCase() && !0 !== b._isStopDraw) {
        b._isStartDraw = !0
        var d = document.createElementNS('http://www.w3.org/2000/svg', 'defs'),
          k = document.createElementNS('http://www.w3.org/2000/svg', 'marker'),
          g = document.createElementNS('http://www.w3.org/2000/svg', 'line'),
          h = document.createElementNS('http://www.w3.org/2000/svg', 'path'),
          n = a.offsetX
        h.id = n
        h.setAttribute('d', 'M2,2 L10,6 L2,10 L6,6 L2,2')
        k.id = 'lineMarker' + n
        k.setAttribute('markerUnits', 'strokeWidth')
        k.setAttribute(
          'markerWidth',
          ((b.newSVGWidth / b.newPageWidth) * b._strokeWidth).toString()
        )
        k.setAttribute('markerHeight', '12')
        k.setAttribute('viewBox', '0 0 12 12')
        k.setAttribute('refX', '6')
        k.setAttribute('refY', '6')
        k.setAttribute('orient', 'auto')
        g.setAttribute('stroke', b._strokeColor)
        g.setAttribute(
          'stroke-width',
          ((b.newSVGWidth / b.newPageWidth) * b._strokeWidth).toString()
        )
        g.setAttribute('style', 'fill:transparent;')
        k.appendChild(h)
        d.appendChild(k)
        c.appendChild(d)
        c.appendChild(g)
        var l = a.offsetX,
          p = a.offsetY
        1 < b._defaultHeight &&
          ((l *= b.newSVGWidth / b.newPageWidth),
          (p *= b.newSVGWidth / b.newPageWidth))
        g.setAttribute('x1', l.toString())
        g.setAttribute('y1', p.toString())
        g.setAttribute('x2', l.toString())
        g.setAttribute('y2', p.toString())
        c.onmouseup = function (a) {
          b._nowDrawSvgRectId = guid()
          g.setAttribute('id', b._nowDrawSvgRectId)
          b._0x6FMarkId = guid()
          d.setAttribute('id', b._0x6FMarkId)
          b._isStartDraw = !1
          h.style.fill = b._strokeColor
          var f = a.offsetX
          a = a.offsetY
          1 < b._defaultHeight &&
            ((f *= b.newSVGWidth / b.newPageWidth),
            (a *= b.newSVGWidth / b.newPageWidth))
          f -= l
          a -= p
          20 > Math.sqrt(f * f + a * a) && (c.removeChild(g), c.removeChild(d))
        }
        c.onmousemove = function (a) {
          var c = a.offsetX
          a = a.offsetY
          !0 === b._isStartDraw &&
            (1 < b._defaultHeight &&
              ((c *= b.newSVGWidth / b.newPageWidth),
              (a *= b.newSVGWidth / b.newPageWidth)),
            g.setAttribute('x2', c.toString()),
            g.setAttribute('y2', a.toString()),
            g.setAttribute('marker-end', 'url(#lineMarker' + n + ')'))
        }
        a.stopPropagation()
      } else if ('LINE' === a.target.tagName.toUpperCase()) {
        var m = a.target
        if (m.getAttribute('id') === b._nowDrawSvgRectId) {
          console.log(0)
          var q = !1,
            r = 0,
            u = 0,
            v = 0,
            z = 0,
            y = 0,
            w = 0,
            q = !0,
            r = a.offsetX,
            u = a.offsetY
          1 < b._defaultHeight &&
            ((r *= b.newSVGWidth / b.newPageWidth),
            (u *= b.newSVGWidth / b.newPageWidth))
          console.log('0-1')
          v = parseFloat(m.getAttribute('x1'))
          z = parseFloat(m.getAttribute('y1'))
          y = parseFloat(m.getAttribute('x2'))
          w = parseFloat(m.getAttribute('y2'))
          a.stopPropagation()
          console.log('0-2')
          c.onmousemove = function (a) {
            if (!0 === q) {
              console.log(1)
              var c = a.offsetX,
                d = a.offsetY
              console.log(2)
              1 < b._defaultHeight &&
                (console.log(3),
                (c *= b.newSVGWidth / b.newPageWidth),
                (d *= b.newSVGWidth / b.newPageWidth))
              m.setAttribute('x1', (v + c - r).toString())
              m.setAttribute('y1', (z + d - u).toString())
              m.setAttribute('x2', (y + c - r).toString())
              m.setAttribute('y2', (w + d - u).toString())
              console.log(5)
              a.stopPropagation()
            }
          }
          c.onmouseup = function () {
            console.log(6)
            q = !1
            w = y = z = v = u = r = 0
          }
        }
      }
  }
}
function _0xAA(a) {
  var b = document
  a.target.classList.contains('qm-checked')
    ? a.target.classList.remove('qm-checked')
    : (a.target.classList.add('qm-checked'),
      b._nowChecked && b._nowChecked.classList.remove('qm-checked'),
      (b._nowChecked = a.target))
  _0x5F()
  b._nowDrawType = '_0xAA'
  b._isStopDraw = !1
  _0x4F()
  a = _0x8F()
  var c = _0x7F(a)
  c.onmousedown = function (a) {
    if (!b.ctrlKeyCode)
      if ('SVG' === a.target.tagName.toUpperCase() && !0 !== b._isStopDraw) {
        b._isStartDraw = !0
        var d = document.createElementNS('http://www.w3.org/2000/svg', 'path')
        d.setAttribute('stroke', b._strokeColor)
        d.setAttribute(
          'stroke-width',
          ((b.newSVGWidth / b.newPageWidth) * b._strokeWidth).toString()
        )
        d.setAttribute('style', 'fill:transparent;')
        c.appendChild(d)
        var k = a.offsetX,
          g = a.offsetY
        1 < b._defaultHeight &&
          ((k *= b.newSVGWidth / b.newPageWidth),
          (g *= b.newSVGWidth / b.newPageWidth))
        c.onmouseup = function (a) {
          b._nowDrawSvgRectId = guid()
          console.log('thisbak._nowDrawSvgRectId:' + b._nowDrawSvgRectId)
          d.setAttribute('id', b._nowDrawSvgRectId)
          d.setAttribute('x', k)
          d.setAttribute('y', g)
          b._isStartDraw = !1
        }
        c.onmousemove = function (a) {
          var c = a.offsetX,
            f = a.offsetY
          if (!0 === b._isStartDraw) {
            1 < b._defaultHeight &&
              ((c *= b.newSVGWidth / b.newPageWidth),
              (f *= b.newSVGWidth / b.newPageWidth))
            a = [
              0,
              0,
              -13,
              -39,
              35,
              -42,
              17,
              -47,
              57,
              -21,
              57,
              -21,
              40,
              -21,
              58,
              11,
              58,
              11,
              38,
              -5,
              37,
              37,
              37,
              37,
              15,
              36,
              -8,
              46,
              -23,
              50,
              15,
              4,
              -25,
              23,
              -58,
              16,
              -38,
              23,
              -69,
              -11,
              -70,
              -12,
              -1,
              -1,
              -42,
              -6,
              -36,
              -39,
            ]
            for (
              var c = (c - k) / 200, f = (f - g) / 60, h = '', l = 0;
              8 > l;
              l++
            )
              h +=
                'c' +
                a[6 * l] * c +
                ',' +
                a[6 * l + 1] * f +
                ' ' +
                a[6 * l + 2] * c +
                ',' +
                a[6 * l + 3] * f +
                ' ' +
                a[6 * l + 4] * c +
                ',' +
                a[6 * l + 5] * f
            h += 'z'
            console.log('x:' + k + 'y:' + g)
            d.setAttributeNS(
              null,
              'd',
              'm' + k.toString() + ',' + g.toString() + h
            )
          }
        }
        a.stopPropagation()
      } else if ('PATH' === a.target.tagName.toUpperCase()) {
        var h = a.target
        if (h.getAttribute('id') === b._nowDrawSvgRectId) {
          console.log(0)
          var n = !1,
            l = 0,
            p = 0,
            m = 0,
            q = 0,
            n = !0,
            l = a.offsetX,
            p = a.offsetY
          1 < b._defaultHeight &&
            ((l *= b.newSVGWidth / b.newPageWidth),
            (p *= b.newSVGWidth / b.newPageWidth))
          console.log('0-1')
          var r = h.getAttribute('d').split(','),
            m = parseFloat(r[0].replace('m', '')),
            u = r[1].lastIndexOf('c'),
            v = r[1].substr(u),
            q = parseFloat(r[1].substring(0, u))
          a.stopPropagation()
          console.log('0-2')
          c.onmousemove = function (a) {
            if (!0 === n) {
              console.log(1)
              var c = a.offsetX,
                d = a.offsetY
              console.log(2)
              1 < b._defaultHeight &&
                (console.log(3),
                (c *= b.newSVGWidth / b.newPageWidth),
                (d *= b.newSVGWidth / b.newPageWidth))
              console.log(4)
              console.log('mouse:' + (m + c - l).toString())
              r[0] = 'm' + (m + c - l).toString()
              r[1] = (q + d - p).toString() + v
              h.setAttribute('d', r.join(','))
              console.log('pathD:' + r.join(','))
              a.stopPropagation()
            }
          }
          c.onmouseup = function () {
            console.log(6)
            n = !1
            q = m = p = l = 0
          }
        }
      }
  }
}
function _0xAC(a) {
  var b = this
  a.document.onkeydown = function (a) {
    46 === a.keyCode &&
      (null != b._element && (b._element.remove(), (b._element = null)),
      null != b._svgImageElement &&
        (b._svgImageElement.remove(), (b._svgImageElement = null)))
    if (189 === a.keyCode && null != b._svgImageElement) {
      var c = parseFloat(
          b._svgImageElement.getAttribute('width').replace('px', '')
        ),
        f = parseFloat(
          b._svgImageElement.getAttribute('height').replace('px', '')
        )
      b._svgImageElement.setAttribute('width', 0.99 * c + 'px')
      b._svgImageElement.setAttribute('height', 0.99 * f + 'px')
    }
    187 === a.keyCode &&
      null != b._svgImageElement &&
      ((c = parseFloat(
        b._svgImageElement.getAttribute('width').replace('px', '')
      )),
      (f = parseFloat(
        b._svgImageElement.getAttribute('height').replace('px', '')
      )),
      b._svgImageElement.setAttribute('width', 1.01 * c + 'px'),
      b._svgImageElement.setAttribute('height', 1.01 * f + 'px'))
    13 === a.keyCode &&
      null != b._svgImageElement &&
      (parseFloat(b._svgImageElement.getAttribute('width').replace('px', '')),
      parseFloat(b._svgImageElement.getAttribute('height').replace('px', '')))
  }
}
function _0xAD(a) {
  var b = document
  a.target.classList.contains('qm-checked')
    ? a.target.classList.remove('qm-checked')
    : (a.target.classList.add('qm-checked'),
      b._nowChecked && b._nowChecked.classList.remove('qm-checked'),
      (b._nowChecked = a.target))
  _0x5F()
  var c = !0
  b._nowDrawType = '_0xAD'
  b._textFontSize = 10
  _0x4F()
  a = _0x8F()
  var d = _0x7F(a)
  _0xAC(a)
  d.onmousedown = function (a) {
    if (!b.ctrlKeyCode) {
      var f = $(
        '\x3cinput class\x3d"drawtext" type\x3d"text"  size\x3d"10"/\x3e'
      )
      f.css('top', (a.screenY - 70).toString() + 'px')
      f.css('left', a.screenX.toString() + 'px')
      f.css('position', 'absolute')
      f.css('font-size', b._textFontSize.toString() + 'px')
      f.css('z-index', '10000')
      f.css('color', b._textColor)
      c || (f = null)
      var g = a.offsetX,
        h = a.offsetY
      document.getElementById('dwgFileList')
      c &&
        (f.blur(function () {
          var a = $(this).val(),
            f = document.createElementNS('http://www.w3.org/2000/svg', 'text'),
            k = g,
            m = h + b._textFontSize
          1 < b._defaultHeight &&
            ((k *= b.newSVGWidth / b.newPageWidth),
            (m *= b.newSVGWidth / b.newPageWidth))
          f.setAttribute('x', k.toString())
          f.setAttribute('y', m.toString())
          f.setAttribute('stroke', b._textColor)
          f.setAttribute('fill', b._textColor)
          f.setAttribute(
            'style',
            'font-size:' +
              (
                (b.newSVGWidth / b.newPageWidth) *
                b._textFontSize *
                1.3
              ).toString() +
              'px'
          )
          f.textContent = a
          $(this).remove()
          d.appendChild(f)
          b._nowDrawSvgRectId = guid()
          f.setAttribute('id', b._nowDrawSvgRectId)
          '_0xAD' === b._nowDrawType && (c = !1)
          _0x5F()
          f.addEventListener(
            'mouseover',
            function () {
              this.style.stroke = 'yellow'
              this.style.fontWeight = 'Bold'
            },
            !1
          )
          f.addEventListener(
            'mouseout',
            function () {
              this.style.stroke = ''
              this.style.fontWeight = ''
            },
            !1
          )
          f.addEventListener('click', function () {}, !1)
        }),
        $(document.body).append(f))
      c = !1
      setTimeout(function () {
        c && f.focus()
      }, 50)
      a.stopPropagation()
    }
  }
}
function _0xAF() {
  var a = document
  null != a.viewerElement.querySelector('iframe') &&
    ((a = a.viewerElement.querySelector('iframe').contentWindow),
    (a = _0x9F(a)),
    null != a &&
      ((a = a.querySelector('svg')),
      null != a && a.remove(),
      (this._nowDrawType = '')))
}
function _0xBA(a) {
  _0x5F()
  var b = document
  a.target.classList.contains('qm-checked')
    ? a.target.classList.remove('qm-checked')
    : (a.target.classList.add('qm-checked'),
      b._nowChecked && b._nowChecked.classList.remove('qm-checked'),
      (b._nowChecked = a.target))
  b._nowDrawType = '_0xBA'
  b._isStopDraw = !1
  console.log('_0xBA')
  _0x4F()
  a = _0x8F()
  var c = _0x7F(a)
  c.onmousedown = function (a) {
    if (!b.ctrlKeyCode)
      if ('SVG' === a.target.tagName.toUpperCase() && !0 !== b._isStopDraw) {
        b._isStartDraw = !0
        var d = document.createElementNS('http://www.w3.org/2000/svg', 'circle')
        d.setAttribute('stroke', b._strokeColor)
        d.setAttribute(
          'stroke-width',
          ((b.newSVGWidth / b.newPageWidth) * b._strokeWidth).toString()
        )
        d.setAttribute('style', 'fill:transparent;')
        d.setAttribute('id', guid())
        c.appendChild(d)
        var k = a.offsetX,
          g = a.offsetY
        1 < b._defaultHeight &&
          ((k *= b.newSVGWidth / b.newPageWidth),
          (g *= b.newSVGWidth / b.newPageWidth))
        c.onmouseup = function (a) {
          b._nowDrawSvgRectId = guid()
          d.setAttribute('id', b._nowDrawSvgRectId)
          b._isStartDraw = !1
        }
        c.onmousemove = function (a) {
          var c = a.offsetX
          a = a.offsetY
          !0 === b._isStartDraw &&
            (1 < b._defaultHeight &&
              ((c *= b.newSVGWidth / b.newPageWidth),
              (a *= b.newSVGWidth / b.newPageWidth)),
            d.setAttribute(
              'r',
              (
                Math.sqrt(Math.pow(c - k, 2) + Math.pow(a - g, 2)) / 2
              ).toString()
            ),
            (c = c > k ? k + (c - k) / 2 : c + (k - c) / 2),
            (a = a > g ? g + (a - g) / 2 : a + (g - a) / 2),
            d.setAttribute('cx', c.toString()),
            d.setAttribute('cy', a.toString()))
        }
        a.stopPropagation()
      } else if ('CIRCLE' === a.target.tagName.toUpperCase()) {
        var h = a.target
        if (h.getAttribute('id') === b._nowDrawSvgRectId) {
          console.log(0)
          var n = !1,
            l = 0,
            p = 0,
            m = 0,
            q = 0,
            n = !0,
            l = a.offsetX,
            p = a.offsetY
          1 < b._defaultHeight &&
            ((l *= b.newSVGWidth / b.newPageWidth),
            (p *= b.newSVGWidth / b.newPageWidth))
          console.log('0-1')
          m = parseFloat(h.getAttribute('cx'))
          q = parseFloat(h.getAttribute('cy'))
          a.stopPropagation()
          console.log('0-2')
          c.onmousemove = function (a) {
            if (!0 === n) {
              console.log(1)
              var c = a.offsetX,
                d = a.offsetY
              console.log(2)
              1 < b._defaultHeight &&
                (console.log(3),
                (c *= b.newSVGWidth / b.newPageWidth),
                (d *= b.newSVGWidth / b.newPageWidth))
              console.log(4)
              console.log('mouse:' + (m + c - l).toString())
              h.setAttribute('cx', (m + c - l).toString())
              h.setAttribute('cy', (q + d - p).toString())
              console.log(5)
              a.stopPropagation()
            }
          }
          c.onmouseup = function () {
            console.log(6)
            n = !1
            q = m = p = l = 0
          }
        }
      }
  }
}
function Init2D() {
  var a = document
  a._nowPageNum = 0
  a._strokeColor
  a._strokeWidth
  a._page = 1
  a._firstzoom = 0
  a._nowPageNum = 1
  a._numPages = 0
  a._strokeColor = 'red'
  a._strokeWidth = 2
  a._textFontSize = 14
  a._textColor = 'red'
  a._defaultHeight = 2
  a._nowChecked = null
  var b = _0xBC('file'),
    b = b.replace(/szths/g, '#'),
    b = b.replace(/\\/g, '/')
  console.log(b)
  var c = b,
    d = c.lastIndexOf('/')
  url = c.substring(0, d)
  afile = b.substring(d)
  b = url + encodeURIComponent(afile)
  c = document.getElementById('viewerElement')
  a.viewerElement = c
  c = new PDFTron.WebViewer(
    {
      path: 'lib',
      type: 'html5',
      l: 'qmodel.cn',
      documentType: 'pdf',
      initialDoc: b + '.pdf',
      mobileRedirect: !1,
    },
    c
  )
  a.myWebViewer = c
  document.height = '100%'
  document.body.height = '100%'
  $('.qmd-nrectangle').on('click', _0xBB)
  $('.qmd-narrow').on('click', _0x6F)
  $('.qmd-n-cloud').on('click', _0xAA)
  $('.qmd-noval').on('click', _0xBA)
  $('.qmd-ntext').on('click', _0xAD)
}
function _0xBB(a) {
  _0x5F()
  var b = document
  a.target.classList.contains('qm-checked')
    ? a.target.classList.remove('qm-checked')
    : (a.target.classList.add('qm-checked'),
      b._nowChecked && b._nowChecked.classList.remove('qm-checked'),
      (b._nowChecked = a.target))
  b._nowDrawType = '_0xBB'
  b._isStopDraw = !1
  _0x4F()
  a = _0x8F()
  var c = _0x7F(a)
  c.onmousedown = function (a) {
    if (!b.ctrlKeyCode)
      if ('SVG' === a.target.tagName.toUpperCase() && !0 !== b._isStopDraw) {
        b._isStartDraw = !0
        var d = document.createElementNS('http://www.w3.org/2000/svg', 'rect')
        d.setAttribute('stroke', b._strokeColor)
        d.setAttribute(
          'stroke-width',
          ((b.newSVGWidth / b.newPageWidth) * b._strokeWidth).toString()
        )
        d.setAttribute('style', 'fill:transparent;')
        d.setAttribute('id', guid())
        c.appendChild(d)
        var k = a.offsetX,
          g = a.offsetY
        console.log('x:' + k + 'y:' + g)
        console.log(
          'newPageWidth:' + b.newPageWidth + 'newSVGWidth:' + b.newSVGWidth
        )
        1 < b._defaultHeight &&
          ((k *= b.newSVGWidth / b.newPageWidth),
          (g *= b.newSVGWidth / b.newPageWidth))
        d.setAttribute('x', k.toString())
        d.setAttribute('y', g.toString())
        console.log('x:' + k + 'y:' + g)
        c.onmouseup = function (a) {
          b._nowDrawSvgRectId = guid()
          d.setAttribute('id', b._nowDrawSvgRectId)
          b._isStartDraw = !1
        }
        c.onmousemove = function (a) {
          var c = a.offsetX
          a = a.offsetY
          1 < b._defaultHeight &&
            ((c *= b.newSVGWidth / b.newPageWidth),
            (a *= b.newSVGWidth / b.newPageWidth))
          !0 === b._isStartDraw &&
            (d.setAttribute('width', Math.abs(c - k).toString()),
            d.setAttribute('height', Math.abs(a - g).toString()))
        }
        a.stopPropagation()
      } else if ('RECT' === a.target.tagName.toUpperCase()) {
        var h = a.target
        if (h.getAttribute('id') === b._nowDrawSvgRectId) {
          var n = !1,
            l = 0,
            p = 0,
            m = 0,
            q = 0,
            n = !0,
            l = a.offsetX,
            p = a.offsetY
          1 < b._defaultHeight &&
            ((l *= b.newSVGWidth / b.newPageWidth),
            (p *= b.newSVGWidth / b.newPageWidth))
          m = parseFloat(h.getAttribute('x'))
          q = parseFloat(h.getAttribute('y'))
          a.stopPropagation()
          c.onmousemove = function (a) {
            if (!0 === n) {
              var c = a.offsetX,
                d = a.offsetY
              1 < b._defaultHeight &&
                (console.log(3),
                (c *= b.newSVGWidth / b.newPageWidth),
                (d *= b.newSVGWidth / b.newPageWidth))
              console.log('mouse:' + (m + c - l).toString())
              h.setAttribute('x', (m + c - l).toString())
              h.setAttribute('y', (q + d - p).toString())
              a.stopPropagation()
            }
          }
          c.onmouseup = function () {
            console.log(6)
            n = !1
            q = m = p = l = 0
          }
        }
      }
  }
}
function _0xBC(a) {
  a = new RegExp('(^|\x26)' + a + '\x3d([^\x26]*)(\x26|$)', 'i')
  a = window.location.search.substr(1).match(a)
  return null != a && 1 < a.length ? decodeURI(a[2]) : null
}
function _0x4F() {
  var a = this.viewerElement.querySelector('iframe').contentWindow,
    b = this._0x9F(a),
    c = document
  c.newPageWidth = b.offsetWidth
  c.newPageHeight = b.offsetHeight
  b.setAttribute('data-page-number', c._nowPageNum.toString())
  if (!b.querySelector('svg')) {
    c.restoreZoom = c.myWebViewer.getZoomLevel()
    c.newPageWidth = b.offsetWidth
    c.newPageHeight = b.offsetHeight
    var d = document.createElementNS('http://www.w3.org/2000/svg', 'svg')
    d.setAttribute('data-pdf-annotate-page', c._nowPageNum.toString())
    d.setAttribute('class', 'annotationLayer')
    d.setAttribute('width', c.newPageWidth.toString())
    d.setAttribute('height', c.newPageHeight.toString())
    d.setAttribute(
      'viewBox',
      '0 0 ' +
        ((c.newPageWidth / c.restoreZoom) * 10).toFixed(1) +
        ' ' +
        ((c.newPageHeight / c.restoreZoom) * 10).toFixed(1)
    )
    b.appendChild(d)
    var f
    d.onmouseover = function (b) {
      var d = b.target
      'SVG' !== d.tagName.toUpperCase() &&
        !0 !== c._isStartDraw &&
        ((f = d.getAttribute('stroke-width')),
        d.setAttribute('stroke-width', (3 * parseInt(f)).toString()),
        (a.document.onkeydown = function (a) {
          46 === a.keyCode && d.remove()
        }))
    }
    d.onmouseout = function (a) {
      a = a.target
      'SVG' !== a.tagName.toUpperCase() &&
        !0 !== c._isStartDraw &&
        f &&
        (a.setAttribute('stroke-width', f), (f = void 0))
    }
    c.newSVGWidth = parseFloat(
      ((c.newPageWidth / c.restoreZoom) * 10).toFixed(1)
    )
  }
}
